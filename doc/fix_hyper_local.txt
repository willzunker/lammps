"LAMMPS WWW Site"_lws - "LAMMPS Documentation"_ld - "LAMMPS Commands"_lc :c

:link(lws,http://lammps.sandia.gov)
:link(ld,Manual.html)
:link(lc,Section_commands.html#comm)

:line

fix hyper/local command :h3

[Syntax:]

fix ID group-ID hyper/local cutbond qfactor Vmax Tequil Dcut alpha boost :pre

ID, group-ID are documented in "fix"_fix.html command :ulb,l
hyper/local = style name of this fix command :l
cutbond = max distance at which a pair of atoms is considered bonded (distance units) :l
qfactor = max strain at which bias potential goes to 0.0 (unitless) :l
Vmax = estimated height of bias potential (energy units) :l
Tequil = equilibration temperature (temperature units) :l
Dcut = min distance between boosted bonds (distance units) :l
alpha = boostostat relaxation time (time units) :l
boost = desired time boost factor (unitless) :l
zero or more keyword/value pairs may be appended :l
keyword = {histo} or {lost} or {check/bias} or {check/coeff}
  {histo} values = Nevery Nbin delta Nout
    Nevery = histogram bond bias coefficients every this many timesteps
    Nbin = # of histogram bins
    delta = width of each histogram bin
    Nout = output histogram counts every this many timesteps
  {lostbond} value = error/warn/ignore
  {check/bias} values = Nevery error/warn/ignore
  {check/coeff} values = Nevery error/warn/ignore :pre
:ule

[Examples:]

fix 1 all hyper/local 1.0 0.3 0.8 300.0 :pre

[Description:]

This fix is meant to be used with the "hyper"_hyper.html command to
perform a bond-boost hyperdynamics simulation.  The role of this fix
is a select a multiple pairs of atoms within the system at each
timestep to add a local bias potential to, which will alter their
dynamics.  This is in contrast to the "fix
hyper/global"_fix_hyper_global.html command, which adds a global bias
potential to a single pair of atoms at each timestep.

For a system that undergoes rare transition events, where one or more
atoms move across an energy barrier to a new potential energy basin,
the effect of the bias potential is to induce more rapid transitions.
This can lead to a dramatic speed-up in the rate at which events
occurs, without altering their relative frequencies, thus leading to
an overall dramatic speed-up in the effective wall-clock time of the
simulation.

Cite various papers.

The current strain of a bond IJ is defined as

Eij = (Rij - R0ij) / R0ij

Emax = is the max of the absolute value of Eij for all IJ bonds.

dVij = Vmax * (1 - (Eij/q)^2) for abs(Eij) < q
     = 0  otherwise

Delta Vbias = minimum of dVij for all IJ bonds

The boost factor B = exp(beta * Delta Vbias)
for a single timestep.

Thus the accumulated hypertime is simply

t_hyper = Sum (i = 1 to Nsteps) Bi * dt

NOTE: Add eqs for boostostat and boost coeff.
Explain how many bonds are boosted simultaneously
and how to choose boost factor and initial Vmax.

The {cutbond} argument is the cutoff distance for defining bonds
between pairs of nearby atoms.  A pair of atoms in their equilibrium,
minimum-energy config, which are a distance Rij < cutbond, are
defined as a bonded pair.

The {qfactor} argument is the limiting strain at which
the Vbias (the bias potential) goes to 0.0.

If qfactor is too big, then transitions are affected b/c
the bias energy is non-zero at the transitions.  If it is
too small than not must boost is achieved for a large system
with many bonds (some bonds Eij always exceeds qfactor).

The {Vmax} argument is the initial prefactor on the bias potential.
Should be chosen as estimate of final.  Will be adjusted by
boost cooeficient

The {Tequil} argument is part of the beta term in the
exponential factor that determines how much boost is
achieved as a function of the bias potential.

The {Dcut} argument is the distance required between two bonds for
them to be selected as both being boosted.  The distance is between
the center points of each bond.  Actually between any pair of atoms in
either bond.

The {alpha} argument is a pre-factor on the update equation
for each atom's boostostat:

NOTE: give equation above

Note that the units for {alpha} are in time units, similar
to other thermostat or barostat damping parameters

The {boost} argument is the desired boost factor (e.g. 100x)
that all the atoms in the system will experience.  

NOTE: explain how to choose good value for this.  If this parameter is
chosen to be too large, then the bias potential applied to pairs of
bonded atoms may become unphysically large, leading to bad dynamics.
If chosen too small, the hyperdynamics run may be inefficient in the
sense that events take a long time to occur.

[Restart, fix_modify, output, run start/stop, minimize info:]

No information about this fix is written to "binary restart
files"_restart.html.

The "fix_modify"_fix_modify.html {energy} option is supported by this
fix to add the energy of the bias potential to the the system's
potential energy as part of "thermodynamic output"_thermo_style.html.

This fix computes a global scalar and global vector of length 23,
which can be accessed by various "output
commands"_Section_howto.html#howto_15.  The scalar is the magnitude of
the bias potential (energy units) applied on the current timestep,
summed over all biased bonds.  The vector stores the following
quantities:

1 = # of boosted bonds on this step
2 = max strain of any bond on this step (unitless)
3 = average bias potential for all bonds on this step (energy units)
4 = average bonds/atom on this step
5 = average neighbor bonds/bond on this step :ul

6 = fraction of steps and bonds with no bias during this run
7 = max drift distance of any atom during this run (distance units)
8 = max bond length during this run (distance units)
9 = average # of boosted bonds/step during this run
10 = average bias potential for all bonds during this run (energy units)
11 = max bias potential for any bond during this run (energy units)
12 = min bias potential for any bond during this run (energy units)
13 = max distance from my box of any ghost atom with maxstrain < qfactor during th
is run (distance units)
14 = max distance outside my box of any ghost atom with any maxstrain during this run (distance units)
15 = count of ghost neighbor atoms not found on reneighbor steps during this run
16 = count of lost bond partners during this run
17 = average bias coeff for lost bond partners during this run
18 = count of bias overlaps found during this run
19 = count of non-matching bias coefficients found during this run :ul

20 = cummulative hyper time since fix created (time units)
21 = cummulative count of event timesteps since fix created
22 = cummulative count of atoms in events since fix created
23 = cummulative # of new bonds since fix created :ul

The first quantities (1-5) are for the current timestep.  The
quantities 6-19 are for the current hyper run.  They are reset each
time a new hyper run is performed.  The quantities 20-23 are
cummulative across multiple hyper runs,  They are only set to initial
values once, when this fix is defined in the input script.

For value 6, the numerator is a count of all biased bonds on every
timestep whose bias value = 0.0.  The denominator is the count of all
biased bonds on all timesteps.

For values 13 and 14, the maxstrain of a ghost atom is the maxstrain
of any bond it is part of, and it is checked for ghost atoms within
the bond neighbor cutoff.

The scalar and vector values calculated by this fix are all
"intensive".

No parameter of this fix can be used with the {start/stop} keywords of
the "run"_run.html command.  This fix is not invoked during "energy
minimization"_minimize.html.

[Restrictions:]

This fix is part of the REPLICA package.  It is only enabled if LAMMPS
was built with that package.  See the "Making
LAMMPS"_Section_start.html#start_3 section for more info.

[Related commands:]

"hyper"_hyper.html, "fix hyper/global"_fix_hyper_global.html

[Default:] None

