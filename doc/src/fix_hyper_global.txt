"LAMMPS WWW Site"_lws - "LAMMPS Documentation"_ld - "LAMMPS Commands"_lc :c

:link(lws,http://lammps.sandia.gov)
:link(ld,Manual.html)
:link(lc,Section_commands.html#comm)

:line

fix hyper/global command :h3

[Syntax:]

fix ID group-ID hyper/global cutbond qfactor Vmax Tequil :pre

ID, group-ID are documented in "fix"_fix.html command
hyper/global = style name of this fix command
cutbond = max distance at which a pair of atoms is considered bonded (distance units)
qfactor = max strain at which bias potential goes to 0.0 (unitless)
Vmax = height of bias potential (energy units)
Tequil = equilibration temperature (temperature units) :ul

[Examples:]

fix 1 all hyper/global 1.0 0.3 0.8 300.0 :pre

[Description:]

This fix is meant to be used with the "hyper"_hyper.html command to
perform a bond-boost global hyperdynamics (GHD) simulation.  The role
of this fix is to a select a single pair of atoms in the system at
each timestep to add a global bias potential to, which will alter the
dynamics of the system in a manner that effectively accelerates time.
This is in contrast to the "fix hyper/local"_fix_hyper_local.html
command, which can be user to perform a local hyperdynamics (LHD)
simulation, by adding a local bias potential to multiple pairs of
atoms at each timestep.  GHD can speed-up a small simulation with up
to a few 100 atoms.  For larger systems, LHD is needed to achieve good
speed-ups.

For a system that undergoes rare transition events, where one or more
atoms move over an energy barrier to a new potential energy basin, the
effect of the bias potential is to induce more rapid transitions.
This can lead to a dramatic speed-up in the rate at which events
occurs, without altering their relative frequencies, thus leading to
an overall increase in the elapsed real time of the simulation as
compared to simulating for the same number of timesteps with normal
MD.  See the "hyper"_hyper.html doc page for a more general discussion
of hyperdynamics and citations that explain both GHD and LHD.

The equations and logic used by this fix to perform GHD are as
follows.  This follows the description of GHD given in
"(Voter2013)"_#Voter2013ghd.  The bond-boost form of a bias potential
for GHD is due to Miron and Fichthorn as described in
"(Miron)"_#Mironghd.  Here we use a simplified version of bond-boost
GHD where a single bond is biased at any one timestep.

Bonds are defined between every pair of I,J atoms whose R0ij distance
is less than {cutbond}, when the system is in a quenched state
(minimum) energy.  Note that these are not "bonds" in a covalent
sense.  A bond is simply any pair of atoms that meet the distance
criterion.  {Cutbond} is an argument to this fix; it is discussed more
below.

The current strain of bond IJ (when running dynamics) is defined as

Eij = (Rij - R0ij) / R0ij :pre

where Rij is the current distance between atoms I,J, and R0ij is the
equilibrium distance in the quenched state.

The bias energy Vij of any bond IJ is defined as

Vij = Vmax * (1 - (Eij/q)^2) for abs(Eij) < qfactor
    = 0 otherwise :pre

where the prefactor {Vmax} and the cutoff {qfactor} are arguments to
this fix; they are discussed more below.  This functional form is an
inverse parabola centered at 0.0 with height Vmax and which goes to
0.0 at +/- qfactor.

Let Emax = the maximum of abs(Eij) for all IJ bonds in the system on a
given timestep.  On that step, Vij is added as a bias potential to
only the two atoms IJ in the bond with strain Emax, call it Vij(max).
Note that Vij(max) will be 0.0 if Emax >= qfactor on that timestep.
Also note that Vij(max) is added to the normal interatomic potential
that is computed between all atoms in the system.

The derivative of Vij(max) with respect to the position of each atom
in the Emax bond gives a force Fij(max) acting on the bond as

Fij(max) = - dVij(max)/dEij = 2 Vmax Eij / qfactor^2   for abs(Eij) < qfactor
         = 0 otherwise :pre

which can be decomposed into an equal and opposite force acting (only)
on the two I,J atoms in the Emax bond.

The boost factor in time for the system is given each timestep I by

Bi = exp(beta * Vij(max)) :pre

where beta = 1/kTequil, and {Tequil} is the temperature of the system
and an arguement to this fix.  Note that Bi >= 1 at every step.

NOTE: Must use langevin set to Tequil also.  LAMMPS does not
check that you do this.
as maintained by a thermostat for constant NVT dynamics. 

The elapsed system time t_hyper for a GHD simulation running for {N}
timesteps is simply

t_hyper = Sum (i = 1 to N) Bi * dt :pre

where dt is the timestep size defined by the "timestep"_timestep.html
command.  The effective time acceleration due to GHD is thus t_hyper /
N*dt, where the denominator is elapsed time for a normal MD run.

Note that in global hyperdynamics, the boost factor varies from
timestep to timestep.  Likewise, which bond has Emax strain and thus
which pair of atoms the bias potential is added to, will also vary
from timestep to timestep.

:line

The {cutbond} argument is the cutoff distance for defining bonds
between pairs of nearby atoms.  A pair of atoms in their equilibrium,
minimum-energy config, which are a distance Rij < cutbond, are defined
as a bonded pair.  This should normally be roughly ~25% larger than
the nearest-neighbor distance in a crystalline lattice.

The {qfactor} argument is the limiting strain at which the bias
potential goes to 0.0.

If {qfactor} is set too large, then transitions from one energy basin
to another are affected because the bias potneial is non-zero at the
transitions.  If {qfactor} is set too small than little boost is
achieved because some the Eij strain of some bond is (nearly) always
exceeding {qfactor).  Note

The {Vmax} argument is the prefactor on the bias potential.
It should be set to a value smaller than 

The {Tequil} argument is part of the beta term in the exponential
factor that determines how much boost is achieved as a function of the
bias potential.

[Restart, fix_modify, output, run start/stop, minimize info:]

No information about this fix is written to "binary restart
files"_restart.html.

The "fix_modify"_fix_modify.html {energy} option is supported by this
fix to add the energy of the bias potential to the the system's
potential energy as part of "thermodynamic output"_thermo_style.html.

This fix computes a global scalar and global vector of length 10,
which can be accessed by various "output
commands"_Section_howto.html#howto_15.  The scalar is the magnitude of
the bias potential (energy units) applied on the current timestep.
The vector stores the following quantities:

1 = boost factor on this step (unitless)
2 = max strain Eij of any bond on this step (unitless)
3 = ID of first atom in the max-strain bond
4 = ID of second atom in the max-strain bond
5 = average # of bonds/atom on this step :ul

6 = fraction of steps with bias = 0.0 during this run
7 = max drift distance of any atom during this run (distance units)
8 = max bond length during this run (distance units) :ul

9 = cummulative hyper time since fix created (time units)
10 = cummulative count of event timesteps since fix created
11 = cummulative count of atoms in events since fix created :ul

The first 5 quantities are for the current timestep.  The quantities
6-8 are for the current run.  The quantities 9-11 are cummulative
across multiple runs (since the fix was defined in the input script).

For value 10, events are checked for by the "hyper"_hyper.html command
once every {Nevent} timesteps.  This value is the count of the number
of timesteps on which one (or more) events was detected.  It is NOT
the number of distinct events, since more than one physical event may
occur in the same {Nevent} time window.

For value 11, each time the "hyper"_hyper.html command checks for an
event, the event compute it uses will flag zero or more atoms as
participating in an event.  E.g. atoms that have displaced more than
some distance from the previous quench state.  This value is the count
of the number of atoms participating in any of the events that were
found.

The scalar and vector values calculated by this fix are all
"intensive".

No parameter of this fix can be used with the {start/stop} keywords of
the "run"_run.html command.  This fix is not invoked during "energy
minimization"_minimize.html.

[Restrictions:]

This command can only be used if LAMMPS was built with the REPLICA
package.  See the "Build package"_Build_package.html doc
page for more info.

[Related commands:]

"hyper"_hyper.html, "fix hyper/local"_fix_hyper_local.html

[Default:] None

:link(Voter2013)
[(Voter2013)] S. Y. Kim, D. Perez, A. F. Voter, J Chem Phys, 139,
144110 (2013).

:link(Miron)
[(Miron)] R. A. Miron and K. A. Fichthorn, J Chem Phys, 119, 6210 (2003).
