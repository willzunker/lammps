<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });
</script>

"LAMMPS WWW Site"_lws - "LAMMPS Documentation"_ld - "LAMMPS Commands"_lc :c

:link(lws,http://lammps.sandia.gov)
:link(ld,Manual.html)
:link(lc,Commands_all.html)

:line

pair_style granular command :h3
pair_style granular/multi command :h3

[Syntax:]

pair_style style cutoff :pre

style = {granular} or {granular/multi} :ulb,l
cutoff = global cutoff (optional). See discussion below. :l
:ule

[Examples:]

pair_style granular
pair_coeff * * hertz 1000.0 50.0 tangential mindlin 800.0 50.0 0.4 :pre

pair_style granular
pair_coeff 1 1 hertz 1000.0 50.0 tangential mindlin 800.0 50.0 0.5 rolling sds 500.0 200.0 0.5 twisting marshall 
pair_coeff 2 2 hertz 200.0 20.0 tangential mindlin 300.0 50.0 0.1 rolling sds 200.0 100.0 0.1 twisting marshall :pre

pair_style granular/multi
pair_coeff 1 1 hertz 1000.0 50.0 tangential mindlin 800.0 50.0 0.5 rolling sds 500.0 200.0 0.5 twisting marshall 
pair_coeff 2 2 dmt 1000.0 50.0 800.0 10.0 tangential mindlin 800.0 50.0 0.1 roll sds 500.0 200.0 0.1 twisting marshall
pair_coeff 1 2 dmt 1000.0 50.0 800.0 10.0 tangential mindlin 800.0 50.0 0.1 roll sds 500.0 200.0 0.1 twisting marshall :pre


[Description:]

The {granular} styles support a variety of options for the normal, tangential, rolling and twisting
forces resulting from contact between two granular particles. This expands on the options offered
by the "pair gran/*"_pair_gran.html options. The total computed forces and torques depend on the combination
of choices for these various modes of motion.

All model options and parameters are entered in the "pair_coeff"_pair_coeff.html command, as described below. 
Unlike e.g. "pair gran/hooke"_pair_gran.html, coefficient values are not global, but can be set to different values for 
various combinations of particle types, as determined by the "pair_coeff"_pair_coeff.html command.
For {pair_style granular}, coefficients can vary between particle types, but model choices 
cannot. For instance, in the first 
example above, the stiffness, damping, and tangential friction are different for 
type 1 - type 1 and type 2 - type 2 interactions, but
both 1-1 and 2-2 interactions must have the same model form, hence all keywords are 
identical between the two types. Cross-coefficients
for 1-2 interactions for the case of the {hertz} model above are set via simple 
geometric mixing rules. The {granular/multi}
style removes this restriction at a small cost in computational efficiency, so that different particle types
can potentially interact via different model forms. As shown in the second example,
1-1 interactions are based on a Hertzian contact model and 2-2 interactions are based on a {dmt} model (see below). 
In the case that 1-1 and 2-2 interactions have different model forms, mixing of coefficients cannot be 
determined, so 1-2 interactions must be explicitly defined via the pair coeff command, otherwise an error results.

:line

The first required keyword for the {pair_coeff} command is the normal contact model. Currently supported options 
for normal contact models and their required arguments are:

{hooke} : \(k_n\), damping
{hertz} : \(k_n\), damping
{hertz/material} : E, damping, G
{dmt} : E, damping, G, cohesion
{jkr} : E, damping, G, cohesion :ol
   
Here, \(k_n\) is spring stiffness, damping is a damping constant or a coefficient of restitution, depending on
the choice of damping model (see below), E and G are Young's modulus and shear modulus, in units of pressure, 
and cohesion is a surface energy density, in units of energy/length^2. 

For the {hooke} model, the normal (elastic) component of force between two particles {i} and {j} is given by:
\begin\{equation\}
\mathbf\{F\}_\{ne, Hooke\} = k_N \delta_\{ij\} \mathbf\{n\}
\end\{equation\}

Where \(\delta =  R_i + R_j - \|\mathbf\{r\}_\{ij\}\|\) is the particle overlap,
\(R_i, R_j\) are the particle radii, 
\(\mathbf\{r\}_\{ij\} = \mathbf\{r\}_j - \mathbf\{r\}_i\) is the vector separating the
two particle centers 
and \(\mathbf\{n\} = \frac\{\mathbf\{r\}_\{ij\}\}\{\|\mathbf\{r\}_\{ij\}\|\}\).

For the {hertz} model, the normal component of force is given by:
\begin\{equation\}
\mathbf\{F\}_\{ne, Hertz\} = k_N R_\{eff\}^\{1/2\}\delta_\{ij\}^\{3/2\} \mathbf\{n\}
\end\{equation\}

Here, \(R_\{eff\} = \frac\{R_i R_j\}\{R_i + R_j\}\) is the effective radius, denoted for simplicity as {R} from here on.

For the {hertz/material} model, the force is given by:
\begin\{equation\}
\mathbf\{F\}_\{ne, Hertz/material\} = \frac\{4\}\{3\} E_\{eff\} R_\{eff\}^\{1/2\}\delta_\{ij\}^\{3/2\} \mathbf\{n\}
\end\{equation\}

Here, \(E_\{eff\} = E = \left(\frac\{1-\nu_i^2\}\{E_i\} + \frac\{1-\nu_j^2\}\{E_j\}\right)^\{-1\}\) 
is the effectve Young's modulus,
with \(\nu_i, \nu_j \) the Poisson ratios of the particles, which are related to the
input shear and Young's moduli by \(\nu_i = E_i/2G_i - 1\). Thus, if the elastic and shear moduli of the 
two particles are the same, the {hertz/material}
model is equivalent to the {hertz} model with \(k_N = 4/3 E_\{eff\}\)

The {dmt} model corresponds to the Derjaguin-Muller-Toporov model, 
where the force is simply Hertz with an additional attractive cohesion term:
\begin\{equation\}
\mathbf\{F\}_\{ne, dmt\} = \left(\frac\{4\}\{3\} E R^\{1/2\}\delta_\{ij\}^\{3/2\} - 4\pi\gamma R\right)\mathbf\{n\}
\end\{equation\}

The {jkr} model is the Johnson-Kendall-Roberts model, where the force is computed as:
\begin\{equation\}
\label\{eq:force_jkr\}
\mathbf\{F\}_\{ne, jkr\} = \left(\frac\{4Ea^3\}\{3R\} - 2\pi a^2\sqrt\{\frac\{4\gamma E\}\{\pi a\}\}\right)\mathbf\{n\}
\end\{equation\}

Here, {a} is the radius of the contact zone, related to the overlap \(\delta\) according to:
\begin\{equation\}
\delta = a^2/R - 2\sqrt\{\pi \gamma a/E\}
\end\{equation\}
 
LAMMPS internally inverts the equation above to solve for {a} in terms of \(\delta\), then solves for
the force in the previous equation. Additionally, note that the JKR model allows for a tensile force beyond 
contact (i.e. for \(\delta < 0\)), up to a maximum tensile force of \(-3\pi\gamma R\) (also known as
the 'pull-off' force).
Note that this is a hysteretic effect, where particles that are not contacting initially
will not experience force until they come into contact \(\delta \geq 0\); as they move apart
and (\(\delta < 0\)), they experience a tensile force up to \(-3\pi\gamma R\), 
at which point they will lose contact. 

In addition to the above options, the normal force is augmented by a damping term. The optional
{damping} keyword to the {pair_coeff} command followed by the model choice determines the form of the damping. 
The damping coefficient that was specified for the normal model
settings is used in computing the damping term, as described below. Note this damping parameter
may be interpreted differently depending on the model choice.
The options for the damping model currently supported are:

{velocity}
{viscoelastic}
{tsuji} :ol

If the {damping} keyword is not specified, the {viscoelastic} model is used by default.

For {damping velocity}, the normal damping is simply proportional to the velocity:
\begin\{equation\}
F_\{N,damp\} = -\gamma_N\mathbf\{v\}_\{N,rel\}
\end\{equation\}

Here, \(\gamma_N\) is the damping coefficient, in units of {mass}/{time}, 
\(\mathbf\{v\}_\{N,rel\} = (\mathbf\{v\}_i - \mathbf\{v\}_j) \cdot \mathbf\{n\}\)
is the component of relative velocity along the direction of the vector \(\mathbf\{n\}\) that connects the centers of 
particles {i} and {j}.

The {damping viscoelastic} model is based on the viscoelastic treatment of "(Brilliantov et al)"_#Brill1996,
where the normal damping is given by:
\begin\{equation\}
F_\{N,damp\} = -\gamma_N a m_\{eff\} \mathbf\{v\}_\{N,rel\}
\end\{equation\}

Here, \(m_\{eff\} = m_i m_j/(m_i + m_j)\) is the effective mass, {a} is the contact radius, given by \(a =\sqrt\{R\delta\}\)
for all models except {jkr}, for which it is given implicitly according to \(delta = a^2/R - 2\sqrt\{\pi \gamma a/E\}\).
In this case, \(\gamma_N\) is the damping coefficient, in units of 1/({time}*{distance}).

The {tsuji} model is based on the work of "(Tsuji et al)"_#Tsuji1992. Here, the 

 :line

Following the normal contact model settings, the {pair_coeff} command requires specification 
of the tangential contact model. The required keyword {tangential} is expected, followed by the model choice and associated
parameters. Currently supported tangential model choices and their expected parameters are as follows:
 
{nohistory} : \(\gamma_t\), \(\mu_s\)
{history} : \(k_t\), \(\gamma_t\), \(\mu_s\) :ol

Here, \(\gamma_t\) is the tangential damping coefficient, \(\mu_s\) is the tangential (or sliding) friction
coefficient, and \(k_t\) is the tangential stiffness. 

For {nohistory}, a simple velocity-dependent Coulomb friction criterion is used, which reproduces the behavior
of the {pair gran/hooke} style. The tangential force (\mathbf\{F\}_t\) is given by:

\begin\{equation\}
\mathbf\{F\}_t =  -min(\mu_s \|\mathbf\{F\}_n\|, \gamma_t m_\{eff\}\|\mathbf\{v\}_\{t, rel\}\|) \mathbf\{t\}
\end\{equation\}

Where \(\|\mathbf\{F\}_n\) is the magnitude of the normal force,  
\(\mathbf\{v\}_\{t, rel\} = \mathbf\{v\}_\{t\} - (R_i\Omega_i + R_j\Omega_j) \times \mathbf\{n\}\) is the relative tangential
velocity at the point of contact, \(\mathbf\{v\}_\{t\} = \mathbf\{v\}_n - \)


 :link(Brill1996)
[(Brilliantov et al, 1996)] Brilliantov, N. V., Spahn, F., Hertzsch, J. M., & Poschel, T. (1996). 
Model for collisions in granular gases. Physical review E, 53(5), 5382.
 
 :link(Tsuji1992)
 [(Tsuji et al, 1992)] Tsuji, Y., Tanaka, T., & Ishida, T. (1992). Lagrangian numerical simulation of plug flow of 
 cohesionless particles in a horizontal pipe. Powder technology, 71(3), 239-250.
 
 
 