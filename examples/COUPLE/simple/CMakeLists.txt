cmake_minimum_required(VERSION 3.10)
project(simple CXX)

set(LAMMPS_SRC_DIRECTORY "" CACHE PATH "Path for lammps source")
if(NOT LAMMPS_SRC_DIRECTORY STREQUAL "" AND EXISTS ${LAMMPS_SRC_DIRECTORY}/cmake/CMakeLists.txt)
  option(BUILD_LIB "Build LAMMPS library" ON)
  add_subdirectory(${LAMMPS_SRC_DIRECTORY}/cmake lammps)
  file(MAKE_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/includes)
  execute_process(COMMAND ${CMAKE_COMMAND} -E create_symlink ${LAMMPS_SRC_DIRECTORY}/src ${CMAKE_CURRENT_BINARY_DIR}/includes/lammps)
  target_include_directories(lammps INTERFACE $<BUILD_INTERFACE:${CMAKE_CURRENT_BINARY_DIR}/includes>)
else()
  find_package(LAMMPS REQUIRED)
endif()

add_executable(simple simple.cpp)
target_link_libraries(simple LAMMPS::lammps)
