LAMMPS (21 Nov 2023)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
variable        trequis equal 750.0
variable        prequis_low equal 0.0
variable        prequis_high equal 25.0e4
variable        equilSteps equal 200
variable        runSteps equal 2000
variable        freqdump equal 200
variable        pstime equal step*dt
variable        sxx equal 1.e-4*pxx
variable        syy equal 1.e-4*pyy
variable        szz equal 1.e-4*pzz
variable        sxy equal 1.e-4*pxy
variable        sxz equal 1.e-4*pxz
variable        syz equal 1.e-4*pyz
variable        TK  equal temp
variable        PE  equal pe
variable        KE  equal ke
variable        V   equal vol

dimension       3
boundary        p p p
units           metal
atom_style      atomic
read_data       data.zr_cell
Reading data file ...
  orthogonal box = (0 0 0) to (19.374 33.556752 30.846)
  1 by 2 by 2 MPI processor grid
  reading atoms ...
  864 atoms
  read_data CPU = 0.002 seconds
replicate       1 5 5
Replication is creating a 1x5x5 = 25 times larger system...
  orthogonal box = (0 0 0) to (19.374 167.78376 154.23)
  1 by 2 by 2 MPI processor grid
  21600 atoms
  replicate CPU = 0.001 seconds

change_box      all triclinic
Changing box ...
  triclinic box = (0 0 0) to (19.374 167.78376 154.23) with tilt (0 0 0)

pair_style      hybrid/overlay zero 9.0 eam/fs
pair_coeff * *  zero
pair_coeff * *  eam/fs Zr_2.eam.fs Zr

timestep        0.002

thermo          50
thermo_style    custom step pe ke temp vol pxx pyy pzz pxy pyz pxz

# fix             extra all print 50 "${pstime} ${TK} ${PE} ${KE} ${V} ${sxx} ${syy} ${szz} ${sxy} ${sxz} ${syz}"  file thermo_global_npt_low_temperature_Zr_hcp.dat

velocity        all create ${trequis} 42345 dist gaussian
velocity        all create 750 42345 dist gaussian

# 1st step : compute the bispectrum on 24 nearest neighbors
compute         bnnn all sna/atom 9.0 0.99363 8 0.5 1.0 rmin0 0.0 nnn 24 wmode 1 delta 0.25

# 2nd step : perform dimension reduction + logistic regression
compute         slcsa all slcsa/atom 8 4 dir.slcsa/mean_descriptor.dat dir.slcsa/lda_scalings.dat dir.slcsa/lr_decision.dat dir.slcsa/lr_bias.dat dir.slcsa/mahalanobis_file.dat c_bnnn[*]

#dump            d1 all custom ${freqdump} slcsa_demo.dump id x y z c_slcsa[*]

# for testing only. in production use dump as shown above
compute max_slcsa all reduce max c_slcsa[*]
compute min_slcsa all reduce min c_slcsa[*]
thermo_style    custom step pe ke temp c_max_slcsa[*] c_min_slcsa[*]

#fix            1 all nvt temp ${trequis} ${trequis} 0.100
fix             1 all npt temp ${trequis} ${trequis} 0.100 tri ${prequis_low} ${prequis_low} 1.0
fix             1 all npt temp 750 ${trequis} 0.100 tri ${prequis_low} ${prequis_low} 1.0
fix             1 all npt temp 750 750 0.100 tri ${prequis_low} ${prequis_low} 1.0
fix             1 all npt temp 750 750 0.100 tri 0 ${prequis_low} 1.0
fix             1 all npt temp 750 750 0.100 tri 0 0 1.0

run             ${equilSteps}
run             200
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 4 31 29
  3 neighbor lists, perpetual/occasional/extra = 2 1 0
  (1) pair zero, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
  (2) pair eam/fs, perpetual, trim from (1)
      attributes: half, newton on, cut 9.6
      pair build: trim
      stencil: none
      bin: none
  (3) compute sna/atom, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 11.26 | 11.45 | 11.64 Mbytes
   Step         PotEng         KinEng          Temp      c_max_slcsa[1] c_max_slcsa[2] c_max_slcsa[3] c_max_slcsa[4] c_max_slcsa[5] c_min_slcsa[1] c_min_slcsa[2] c_min_slcsa[3] c_min_slcsa[4] c_min_slcsa[5]
         0  -139689.93      2093.9174      750            7.6195146      15.787294      1.2169942      111.01919      2              7.6195146      15.787294      1.2169942      111.01919      2            
        50  -138733.53      1165.0291      417.29048      8.2778907      18.221432      3.019507       113.65218      2              5.2735872      10.834132      0.042702874    108.2674       2            
       100  -138821.33      1442.648       516.7281       8.3357676      17.470311      2.7073063      113.39999      2              6.145345       12.307441      0.034372881    108.61824      2            
       150  -138607.9       1435.9634      514.33383      8.3817341      17.984657      2.892662       113.40287      2              5.3635301      10.064171      0.030283213    107.5829       2            
       200  -138494.56      1560.9093      559.08699      8.5615388      18.429835      2.8130845      114.31517      2              5.4711815      11.113891      0.074490923    107.87418      2            
Loop time of 9.89929 on 4 procs for 200 steps with 21600 atoms

Performance: 3.491 ns/day, 6.875 hours/ns, 20.203 timesteps/s, 436.395 katom-step/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.61       | 2.618      | 2.622      |   0.3 | 26.45
Neigh   | 0.19338    | 0.19618    | 0.19967    |   0.5 |  1.98
Comm    | 0.051086   | 0.055818   | 0.065206   |   2.4 |  0.56
Output  | 6.9725     | 6.9725     | 6.9725     |   0.0 | 70.43
Modify  | 0.04635    | 0.046617   | 0.046825   |   0.1 |  0.47
Other   |            | 0.01018    |            |       |  0.10

Nlocal:           5400 ave        5431 max        5376 min
Histogram: 1 1 0 0 0 0 1 0 0 1
Nghost:        12889.2 ave       12909 max       12847 min
Histogram: 1 0 0 0 0 0 0 0 1 2
Neighs:         649026 ave      652559 max      642783 min
Histogram: 1 0 0 0 0 0 1 0 1 1
FullNghs:  1.29777e+06 ave 1.30656e+06 max 1.29086e+06 min
Histogram: 1 1 0 0 0 0 1 0 0 1

Total # of neighbors = 5191084
Ave neighs/atom = 240.32796
Neighbor list builds = 5
Dangerous builds = 0
Total wall time: 0:00:11
