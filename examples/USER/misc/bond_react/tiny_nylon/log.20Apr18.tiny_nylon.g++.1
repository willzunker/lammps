LAMMPS (20 Apr 2018)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (../comm.cpp:90)
  using 1 OpenMP thread(s) per MPI task
# two monomer nylon example
# reaction produces a condensed water molecule

units real

boundary p p p

atom_style full

kspace_style pppm 1.0e-4

pair_style lj/class2/coul/long 8.5

angle_style class2

bond_style class2

dihedral_style class2

improper_style class2

read_data tiny_nylon.data
  orthogonal box = (-25 -25 -25) to (25 25 25)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  44 atoms
  reading velocities ...
  44 velocities
  scanning bonds ...
  9 = max bonds/atom
  scanning angles ...
  21 = max angles/atom
  scanning dihedrals ...
  29 = max dihedrals/atom
  scanning impropers ...
  29 = max impropers/atom
  reading bonds ...
  42 bonds
  reading angles ...
  74 angles
  reading dihedrals ...
  100 dihedrals
  reading impropers ...
  44 impropers
  4 = max # of 1-2 neighbors
  6 = max # of 1-3 neighbors
  12 = max # of 1-4 neighbors
  41 = max # of special neighbors

velocity all create 300.0 4928459 dist gaussian

molecule mol1 rxn1_stp1_unreacted.data_template
Read molecule mol1:
  18 atoms with max type 8
  16 bonds with max type 14
  25 angles with max type 28
  23 dihedrals with max type 36
  14 impropers with max type 11
molecule mol2 rxn1_stp1_reacted.data_template
Read molecule mol2:
  18 atoms with max type 9
  17 bonds with max type 13
  31 angles with max type 27
  39 dihedrals with max type 33
  20 impropers with max type 1
molecule mol3 rxn1_stp2_unreacted.data_template
Read molecule mol3:
  15 atoms with max type 9
  14 bonds with max type 13
  25 angles with max type 27
  30 dihedrals with max type 33
  16 impropers with max type 1
molecule mol4 rxn1_stp2_reacted.data_template
Read molecule mol4:
  15 atoms with max type 11
  13 bonds with max type 15
  19 angles with max type 29
  16 dihedrals with max type 32
  10 impropers with max type 13

thermo 50

# dump 1 all xyz 1 test_vis.xyz

fix myrxns all bond/react stabilization yes statted_grp .03   react rxn1 all 1 2.9 mol1 mol2 rxn1_stp1_map   react rxn2 all 1 5 mol3 mol4 rxn1_stp2_map
dynamic group bond_react_MASTER_group defined
dynamic group statted_grp defined
dynamic group bond_react_MASTER_group defined
dynamic group statted_grp defined

fix 1 statted_grp nvt temp 300 300 100

fix 4 bond_react_MASTER_group temp/rescale 1 300 300 10 1

thermo_style custom step temp press density f_myrxns[1] f_myrxns[2]

# restart 100 restart1 restart2

run 10000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (../kspace.cpp:321)
  G vector (1/distance) = 0.0534597
  grid = 2 2 2
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0402256
  estimated relative force accuracy = 0.000121138
  using double precision FFTs
  3d grid and FFT values/proc = 343 8
Neighbor list info ...
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 10.5
  ghost atom cutoff = 10.5
  binsize = 5.25, bins = 10 10 10
  2 neighbor lists, perpetual/occasional/extra = 1 1 0
  (1) pair lj/class2/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d/newton
      bin: standard
  (2) fix bond/react, occasional, copy from (1)
      attributes: half, newton on
      pair build: copy
      stencil: none
      bin: none
WARNING: Inconsistent image flags (../domain.cpp:786)
Per MPI rank memory allocation (min/avg/max) = 33.34 | 33.34 | 33.34 Mbytes
Step Temp Press Density f_myrxns[1] f_myrxns[2] 
       0          300    346.78165 0.0034851739            0            0 
      50    296.70408    -51.30066 0.0034851739            1            0 
     100    275.26011    39.120329 0.0034851739            1            1 
     150    438.68516    35.257539 0.0034851739            1            1 
     200    394.48971    15.444537 0.0034851739            1            1 
     250    356.00369    50.185792 0.0034851739            1            1 
     300    301.25816   -26.891497 0.0034851739            1            1 
     350    279.17264    12.694513 0.0034851739            1            1 
     400    248.71641    10.684558 0.0034851739            1            1 
     450    240.30602    12.963034 0.0034851739            1            1 
     500    252.71279   0.91620356 0.0034851739            1            1 
     550    300.56824    18.541436 0.0034851739            1            1 
     600    306.46441   -1.9736081 0.0034851739            1            1 
     650     336.4537    21.474831 0.0034851739            1            1 
     700    323.46217     8.486376 0.0034851739            1            1 
     750    271.87146    5.9615231 0.0034851739            1            1 
     800    268.43041    36.676068 0.0034851739            1            1 
     850    269.02683    7.6295416 0.0034851739            1            1 
     900    282.03605   -1.4688833 0.0034851739            1            1 
     950    243.69136   -22.771489 0.0034851739            1            1 
    1000    285.01348    17.925748 0.0034851739            1            1 
    1050    383.47985   0.70536985 0.0034851739            1            1 
    1100    368.97167   -4.3046933 0.0034851739            1            1 
    1150    373.64459    6.3491837 0.0034851739            1            1 
    1200    332.90575   -36.501095 0.0034851739            1            1 
    1250    314.04078   -13.382767 0.0034851739            1            1 
    1300    305.84166    4.7713641 0.0034851739            1            1 
    1350    286.22145    37.621803 0.0034851739            1            1 
    1400    265.52855    23.621002 0.0034851739            1            1 
    1450      281.807   -31.266828 0.0034851739            1            1 
    1500    275.33855    33.495565 0.0034851739            1            1 
    1550    273.04973   -22.913871 0.0034851739            1            1 
    1600    308.18478    -17.98151 0.0034851739            1            1 
    1650    333.27664    28.987529 0.0034851739            1            1 
    1700    296.16091   -1.1440455 0.0034851739            1            1 
    1750    365.75611    34.574845 0.0034851739            1            1 
    1800    292.83503   -33.199654 0.0034851739            1            1 
    1850    261.50282    42.608703 0.0034851739            1            1 
    1900    315.14188   -31.058803 0.0034851739            1            1 
    1950    335.12895     12.40597 0.0034851739            1            1 
    2000    278.08586   -5.3178633 0.0034851739            1            1 
    2050    283.23847   -3.3974302 0.0034851739            1            1 
    2100    281.38904   0.70263324 0.0034851739            1            1 
    2150    302.23197    23.372316 0.0034851739            1            1 
    2200    337.49259   -4.8716803 0.0034851739            1            1 
    2250    409.64134   -12.043721 0.0034851739            1            1 
    2300    309.21764   -21.824645 0.0034851739            1            1 
    2350    290.97879    18.690281 0.0034851739            1            1 
    2400      341.816   -16.967741 0.0034851739            1            1 
    2450    310.28034    27.375518 0.0034851739            1            1 
    2500    248.89429    17.061192 0.0034851739            1            1 
    2550    273.10927   0.10481657 0.0034851739            1            1 
    2600    289.56101   -9.7239939 0.0034851739            1            1 
    2650    298.99719   -33.140576 0.0034851739            1            1 
    2700    326.05198   -24.509827 0.0034851739            1            1 
    2750    319.20612    24.305526 0.0034851739            1            1 
    2800     304.8715   -15.076941 0.0034851739            1            1 
    2850    374.38923    2.0874883 0.0034851739            1            1 
    2900    354.01554   -20.595102 0.0034851739            1            1 
    2950    289.89296     48.39731 0.0034851739            1            1 
    3000    312.10013   -8.5105997 0.0034851739            1            1 
    3050    296.97004   -31.008446 0.0034851739            1            1 
    3100    251.72228    35.710197 0.0034851739            1            1 
    3150    315.35895   -43.331536 0.0034851739            1            1 
    3200    334.67773    13.331058 0.0034851739            1            1 
    3250     308.1669    37.236121 0.0034851739            1            1 
    3300    329.47601    30.798598 0.0034851739            1            1 
    3350    299.40055    2.0785585 0.0034851739            1            1 
    3400    272.41031    32.744922 0.0034851739            1            1 
    3450    279.34594   -26.181793 0.0034851739            1            1 
    3500    288.89969     8.935052 0.0034851739            1            1 
    3550     253.4967    9.7244709 0.0034851739            1            1 
    3600    294.83266     19.33305 0.0034851739            1            1 
    3650    290.23794   -5.4939069 0.0034851739            1            1 
    3700     332.5222   -29.834229 0.0034851739            1            1 
    3750    364.63024    20.706191 0.0034851739            1            1 
    3800     295.3842   -6.9434004 0.0034851739            1            1 
    3850    346.84424    37.796066 0.0034851739            1            1 
    3900    265.67286  -0.31628068 0.0034851739            1            1 
    3950      260.455   -2.2571902 0.0034851739            1            1 
    4000    259.82636   -2.2286205 0.0034851739            1            1 
    4050    257.79848    24.520293 0.0034851739            1            1 
    4100    295.58626  -0.42318936 0.0034851739            1            1 
    4150    265.81353   -49.092436 0.0034851739            1            1 
    4200    302.10333    51.715259 0.0034851739            1            1 
    4250    258.98448   -4.8516655 0.0034851739            1            1 
    4300    327.83401    33.717282 0.0034851739            1            1 
    4350    311.59571    23.580382 0.0034851739            1            1 
    4400    300.64237   -31.866661 0.0034851739            1            1 
    4450    294.15643  -0.11927421 0.0034851739            1            1 
    4500    299.83605   -17.560873 0.0034851739            1            1 
    4550    326.83265    32.818482 0.0034851739            1            1 
    4600    260.39068   -8.0567902 0.0034851739            1            1 
    4650    247.93553    19.462991 0.0034851739            1            1 
    4700    214.22252   -34.118303 0.0034851739            1            1 
    4750    203.15329    27.356205 0.0034851739            1            1 
    4800      257.761   -10.407989 0.0034851739            1            1 
    4850     307.1923     11.71101 0.0034851739            1            1 
    4900    319.00942    4.7808306 0.0034851739            1            1 
    4950    282.23989    24.996151 0.0034851739            1            1 
    5000    311.53284   -3.0012665 0.0034851739            1            1 
    5050    317.58212    32.567832 0.0034851739            1            1 
    5100    267.51501   -47.695087 0.0034851739            1            1 
    5150    260.19048    29.046388 0.0034851739            1            1 
    5200    239.83552   -5.4890385 0.0034851739            1            1 
    5250     234.8852   -18.172633 0.0034851739            1            1 
    5300    236.43277    -39.06212 0.0034851739            1            1 
    5350    280.90079   -2.6932923 0.0034851739            1            1 
    5400    316.65266    23.071362 0.0034851739            1            1 
    5450    345.63226    19.573323 0.0034851739            1            1 
    5500    384.57334    41.507217 0.0034851739            1            1 
    5550    317.14278    9.6992897 0.0034851739            1            1 
    5600    279.93243   -12.076895 0.0034851739            1            1 
    5650    268.06471    1.6196401 0.0034851739            1            1 
    5700    271.85714   -40.378455 0.0034851739            1            1 
    5750    313.88363    10.722639 0.0034851739            1            1 
    5800    281.54495    31.914889 0.0034851739            1            1 
    5850    293.34821   -8.3154922 0.0034851739            1            1 
    5900    249.25216   -17.307353 0.0034851739            1            1 
    5950    268.18639   -4.7222512 0.0034851739            1            1 
    6000    302.99398   -52.615528 0.0034851739            1            1 
    6050    314.57931     34.51318 0.0034851739            1            1 
    6100    345.70348    30.334721 0.0034851739            1            1 
    6150    316.59329    31.862519 0.0034851739            1            1 
    6200    317.85346   -32.235221 0.0034851739            1            1 
    6250    282.97676    0.2936745 0.0034851739            1            1 
    6300    267.91814    19.265567 0.0034851739            1            1 
    6350    226.20967   -13.093547 0.0034851739            1            1 
    6400    307.73316    17.439598 0.0034851739            1            1 
    6450    292.16253   -23.275163 0.0034851739            1            1 
    6500    335.05939    26.936463 0.0034851739            1            1 
    6550    380.73546    19.532416 0.0034851739            1            1 
    6600     373.0103    30.879532 0.0034851739            1            1 
    6650    335.37975   -2.1762828 0.0034851739            1            1 
    6700    298.94272   -10.578587 0.0034851739            1            1 
    6750    255.11531   -50.576215 0.0034851739            1            1 
    6800    222.87459    3.0499548 0.0034851739            1            1 
    6850    268.57213   -43.675945 0.0034851739            1            1 
    6900     260.3024    4.7483005 0.0034851739            1            1 
    6950    289.15855     31.62106 0.0034851739            1            1 
    7000    289.11874    21.635533 0.0034851739            1            1 
    7050    361.08776    22.445996 0.0034851739            1            1 
    7100    368.95003    4.8383881 0.0034851739            1            1 
    7150    331.47448   -36.200495 0.0034851739            1            1 
    7200     304.7251    13.982693 0.0034851739            1            1 
    7250    284.09747   0.53758275 0.0034851739            1            1 
    7300    269.17023   -41.571482 0.0034851739            1            1 
    7350    222.07071    25.564662 0.0034851739            1            1 
    7400    304.09598    15.482955 0.0034851739            1            1 
    7450    298.78752   -7.4335841 0.0034851739            1            1 
    7500    328.78697    14.666097 0.0034851739            1            1 
    7550    347.07038   -37.165295 0.0034851739            1            1 
    7600    362.85673     20.52268 0.0034851739            1            1 
    7650    347.15141    2.3383775 0.0034851739            1            1 
    7700    262.10132    33.898374 0.0034851739            1            1 
    7750    275.84724   -33.534813 0.0034851739            1            1 
    7800    281.14075   -18.284372 0.0034851739            1            1 
    7850    264.83337   -30.580199 0.0034851739            1            1 
    7900    257.35275   -35.080567 0.0034851739            1            1 
    7950    286.32446    26.594779 0.0034851739            1            1 
    8000    248.36889    15.605894 0.0034851739            1            1 
    8050    292.55015    28.811985 0.0034851739            1            1 
    8100    312.47888   0.83990451 0.0034851739            1            1 
    8150    285.58532   -15.258185 0.0034851739            1            1 
    8200    292.22819   -38.233195 0.0034851739            1            1 
    8250     321.6208   -19.052143 0.0034851739            1            1 
    8300    319.41332     54.97437 0.0034851739            1            1 
    8350    307.95647    32.009591 0.0034851739            1            1 
    8400    345.58105    8.8535539 0.0034851739            1            1 
    8450    357.75168    12.416896 0.0034851739            1            1 
    8500      370.049    4.3288665 0.0034851739            1            1 
    8550    360.62882    12.618614 0.0034851739            1            1 
    8600    290.10834   -4.8081765 0.0034851739            1            1 
    8650     297.7575   -5.1976816 0.0034851739            1            1 
    8700    286.57505   -31.469549 0.0034851739            1            1 
    8750    307.77059    19.338001 0.0034851739            1            1 
    8800    231.68316    12.159459 0.0034851739            1            1 
    8850    329.13623   -8.7262592 0.0034851739            1            1 
    8900    286.40715    10.326025 0.0034851739            1            1 
    8950    339.43101    2.7809618 0.0034851739            1            1 
    9000    402.53799    19.481869 0.0034851739            1            1 
    9050    349.56449   -4.8450179 0.0034851739            1            1 
    9100    307.64739    16.889327 0.0034851739            1            1 
    9150    276.54451   -34.808372 0.0034851739            1            1 
    9200    233.18668    4.9409791 0.0034851739            1            1 
    9250    266.48384   -19.850366 0.0034851739            1            1 
    9300    289.14808    13.520201 0.0034851739            1            1 
    9350    295.08335    17.156468 0.0034851739            1            1 
    9400    338.08757   -31.112278 0.0034851739            1            1 
    9450    336.64739   -25.697747 0.0034851739            1            1 
    9500    338.10622    1.9241797 0.0034851739            1            1 
    9550    294.82158   -12.043972 0.0034851739            1            1 
    9600     268.9836    12.235553 0.0034851739            1            1 
    9650     279.6269    28.710734 0.0034851739            1            1 
    9700    279.88562   -10.865604 0.0034851739            1            1 
    9750    287.56565    12.975819 0.0034851739            1            1 
    9800    278.39949    4.2088595 0.0034851739            1            1 
    9850    307.61259     9.341169 0.0034851739            1            1 
    9900    317.53581    2.3948493 0.0034851739            1            1 
    9950    332.52938   -14.809185 0.0034851739            1            1 
   10000    401.93365    -7.637581 0.0034851739            1            1 
Loop time of 1.94139 on 1 procs for 10000 steps with 44 atoms

Performance: 445.042 ns/day, 0.054 hours/ns, 5150.945 timesteps/s
99.3% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.26479    | 0.26479    | 0.26479    |   0.0 | 13.64
Bond    | 0.76875    | 0.76875    | 0.76875    |   0.0 | 39.60
Kspace  | 0.32111    | 0.32111    | 0.32111    |   0.0 | 16.54
Neigh   | 0.41333    | 0.41333    | 0.41333    |   0.0 | 21.29
Comm    | 0.025956   | 0.025956   | 0.025956   |   0.0 |  1.34
Output  | 0.0043445  | 0.0043445  | 0.0043445  |   0.0 |  0.22
Modify  | 0.12526    | 0.12526    | 0.12526    |   0.0 |  6.45
Other   |            | 0.01786    |            |       |  0.92

Nlocal:    44 ave 44 max 44 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    62 ave 62 max 62 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    812 ave 812 max 812 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 812
Ave neighs/atom = 18.4545
Ave special neighs/atom = 9.77273
Neighbor list builds = 10000
Dangerous builds = 0

# write_restart restart_longrun
# write_data restart_longrun.data
Total wall time: 0:00:01
