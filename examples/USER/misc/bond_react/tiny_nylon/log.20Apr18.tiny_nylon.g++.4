LAMMPS (20 Apr 2018)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (../comm.cpp:90)
  using 1 OpenMP thread(s) per MPI task
# two monomer nylon example
# reaction produces a condensed water molecule

units real

boundary p p p

atom_style full

kspace_style pppm 1.0e-4

pair_style lj/class2/coul/long 8.5

angle_style class2

bond_style class2

dihedral_style class2

improper_style class2

read_data tiny_nylon.data
  orthogonal box = (-25 -25 -25) to (25 25 25)
  1 by 2 by 2 MPI processor grid
  reading atoms ...
  44 atoms
  reading velocities ...
  44 velocities
  scanning bonds ...
  9 = max bonds/atom
  scanning angles ...
  21 = max angles/atom
  scanning dihedrals ...
  29 = max dihedrals/atom
  scanning impropers ...
  29 = max impropers/atom
  reading bonds ...
  42 bonds
  reading angles ...
  74 angles
  reading dihedrals ...
  100 dihedrals
  reading impropers ...
  44 impropers
  4 = max # of 1-2 neighbors
  6 = max # of 1-3 neighbors
  12 = max # of 1-4 neighbors
  41 = max # of special neighbors

velocity all create 300.0 4928459 dist gaussian

molecule mol1 rxn1_stp1_unreacted.data_template
Read molecule mol1:
  18 atoms with max type 8
  16 bonds with max type 14
  25 angles with max type 28
  23 dihedrals with max type 36
  14 impropers with max type 11
molecule mol2 rxn1_stp1_reacted.data_template
Read molecule mol2:
  18 atoms with max type 9
  17 bonds with max type 13
  31 angles with max type 27
  39 dihedrals with max type 33
  20 impropers with max type 1
molecule mol3 rxn1_stp2_unreacted.data_template
Read molecule mol3:
  15 atoms with max type 9
  14 bonds with max type 13
  25 angles with max type 27
  30 dihedrals with max type 33
  16 impropers with max type 1
molecule mol4 rxn1_stp2_reacted.data_template
Read molecule mol4:
  15 atoms with max type 11
  13 bonds with max type 15
  19 angles with max type 29
  16 dihedrals with max type 32
  10 impropers with max type 13

thermo 50

# dump 1 all xyz 1 test_vis.xyz

fix myrxns all bond/react stabilization yes statted_grp .03   react rxn1 all 1 2.9 mol1 mol2 rxn1_stp1_map   react rxn2 all 1 5 mol3 mol4 rxn1_stp2_map
dynamic group bond_react_MASTER_group defined
dynamic group statted_grp defined
dynamic group bond_react_MASTER_group defined
dynamic group statted_grp defined

fix 1 statted_grp nvt temp 300 300 100

fix 4 bond_react_MASTER_group temp/rescale 1 300 300 10 1

thermo_style custom step temp press density f_myrxns[1] f_myrxns[2]

# restart 100 restart1 restart2

run 10000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (../kspace.cpp:321)
  G vector (1/distance) = 0.0534597
  grid = 2 2 2
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0402256
  estimated relative force accuracy = 0.000121138
  using double precision FFTs
  3d grid and FFT values/proc = 252 2
Neighbor list info ...
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 10.5
  ghost atom cutoff = 10.5
  binsize = 5.25, bins = 10 10 10
  2 neighbor lists, perpetual/occasional/extra = 1 1 0
  (1) pair lj/class2/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d/newton
      bin: standard
  (2) fix bond/react, occasional, copy from (1)
      attributes: half, newton on
      pair build: copy
      stencil: none
      bin: none
WARNING: Inconsistent image flags (../domain.cpp:786)
Per MPI rank memory allocation (min/avg/max) = 33.34 | 33.69 | 34.37 Mbytes
Step Temp Press Density f_myrxns[1] f_myrxns[2] 
       0          300    346.78165 0.0034851739            0            0 
      50    296.70408    -51.30066 0.0034851739            1            0 
     100    275.26011    39.120329 0.0034851739            1            1 
     150    438.68516    35.257539 0.0034851739            1            1 
     200    394.48971    15.444537 0.0034851739            1            1 
     250    356.00369    50.185792 0.0034851739            1            1 
     300    301.25816   -26.891497 0.0034851739            1            1 
     350    279.17264    12.694513 0.0034851739            1            1 
     400    248.71641    10.684558 0.0034851739            1            1 
     450    240.30602    12.963034 0.0034851739            1            1 
     500    252.71279   0.91620356 0.0034851739            1            1 
     550    300.56824    18.541436 0.0034851739            1            1 
     600    306.46441   -1.9736081 0.0034851739            1            1 
     650     336.4537    21.474831 0.0034851739            1            1 
     700    323.46217     8.486376 0.0034851739            1            1 
     750    271.87146    5.9615231 0.0034851739            1            1 
     800    268.43041    36.676068 0.0034851739            1            1 
     850    269.02683    7.6295416 0.0034851739            1            1 
     900    282.03605   -1.4688833 0.0034851739            1            1 
     950    243.69136   -22.771489 0.0034851739            1            1 
    1000    285.01348    17.925748 0.0034851739            1            1 
    1050    383.47985   0.70536985 0.0034851739            1            1 
    1100    368.97167   -4.3046933 0.0034851739            1            1 
    1150    373.64459    6.3491837 0.0034851739            1            1 
    1200    332.90575   -36.501095 0.0034851739            1            1 
    1250    314.04078   -13.382767 0.0034851739            1            1 
    1300    305.84166    4.7713641 0.0034851739            1            1 
    1350    286.22145    37.621803 0.0034851739            1            1 
    1400    265.52855    23.621002 0.0034851739            1            1 
    1450      281.807   -31.266828 0.0034851739            1            1 
    1500    275.33855    33.495565 0.0034851739            1            1 
    1550    273.04973   -22.913871 0.0034851739            1            1 
    1600    308.18478    -17.98151 0.0034851739            1            1 
    1650    333.27664    28.987529 0.0034851739            1            1 
    1700    296.16091   -1.1440455 0.0034851739            1            1 
    1750    365.75611    34.574845 0.0034851739            1            1 
    1800    292.83503   -33.199654 0.0034851739            1            1 
    1850    261.50282    42.608703 0.0034851739            1            1 
    1900    315.14188   -31.058803 0.0034851739            1            1 
    1950    335.12895     12.40597 0.0034851739            1            1 
    2000    278.08586   -5.3178633 0.0034851739            1            1 
    2050    283.23847   -3.3974302 0.0034851739            1            1 
    2100    281.38904   0.70263324 0.0034851739            1            1 
    2150    302.23197    23.372316 0.0034851739            1            1 
    2200    337.49259   -4.8716803 0.0034851739            1            1 
    2250    409.64134   -12.043721 0.0034851739            1            1 
    2300    309.21764   -21.824645 0.0034851739            1            1 
    2350    290.97879    18.690281 0.0034851739            1            1 
    2400      341.816   -16.967741 0.0034851739            1            1 
    2450    310.28034    27.375518 0.0034851739            1            1 
    2500    248.89429    17.061192 0.0034851739            1            1 
    2550    273.10927    0.1048166 0.0034851739            1            1 
    2600    289.56101   -9.7239939 0.0034851739            1            1 
    2650    298.99719   -33.140576 0.0034851739            1            1 
    2700    326.05198   -24.509827 0.0034851739            1            1 
    2750    319.20612    24.305526 0.0034851739            1            1 
    2800     304.8715   -15.076941 0.0034851739            1            1 
    2850    374.38923    2.0874883 0.0034851739            1            1 
    2900    354.01554   -20.595102 0.0034851739            1            1 
    2950    289.89296     48.39731 0.0034851739            1            1 
    3000    312.10013   -8.5105996 0.0034851739            1            1 
    3050    296.97004   -31.008446 0.0034851739            1            1 
    3100    251.72228    35.710197 0.0034851739            1            1 
    3150    315.35895   -43.331536 0.0034851739            1            1 
    3200    334.67773    13.331058 0.0034851739            1            1 
    3250     308.1669    37.236121 0.0034851739            1            1 
    3300    329.47601    30.798598 0.0034851739            1            1 
    3350    299.40055    2.0785585 0.0034851739            1            1 
    3400    272.41031    32.744921 0.0034851739            1            1 
    3450    279.34594   -26.181793 0.0034851739            1            1 
    3500    288.89969     8.935052 0.0034851739            1            1 
    3550     253.4967     9.724471 0.0034851739            1            1 
    3600    294.83266     19.33305 0.0034851739            1            1 
    3650    290.23794    -5.493907 0.0034851739            1            1 
    3700     332.5222    -29.83423 0.0034851739            1            1 
    3750    364.63024    20.706191 0.0034851739            1            1 
    3800     295.3842   -6.9434003 0.0034851739            1            1 
    3850    346.84424    37.796066 0.0034851739            1            1 
    3900    265.67286   -0.3162804 0.0034851739            1            1 
    3950      260.455   -2.2571901 0.0034851739            1            1 
    4000    259.82636   -2.2286207 0.0034851739            1            1 
    4050    257.79848    24.520293 0.0034851739            1            1 
    4100    295.58626  -0.42318895 0.0034851739            1            1 
    4150    265.81352   -49.092436 0.0034851739            1            1 
    4200    302.10333    51.715258 0.0034851739            1            1 
    4250    258.98448   -4.8516657 0.0034851739            1            1 
    4300    327.83401    33.717283 0.0034851739            1            1 
    4350    311.59571    23.580382 0.0034851739            1            1 
    4400    300.64237   -31.866661 0.0034851739            1            1 
    4450    294.15642  -0.11927262 0.0034851739            1            1 
    4500    299.83605   -17.560872 0.0034851739            1            1 
    4550    326.83265    32.818481 0.0034851739            1            1 
    4600    260.39068   -8.0567907 0.0034851739            1            1 
    4650    247.93553    19.462991 0.0034851739            1            1 
    4700    214.22252   -34.118304 0.0034851739            1            1 
    4750    203.15329    27.356204 0.0034851739            1            1 
    4800      257.761   -10.407986 0.0034851739            1            1 
    4850     307.1923    11.711008 0.0034851739            1            1 
    4900    319.00942    4.7808342 0.0034851739            1            1 
    4950     282.2399    24.996151 0.0034851739            1            1 
    5000    311.53284   -3.0012669 0.0034851739            1            1 
    5050    317.58213     32.56782 0.0034851739            1            1 
    5100    267.51502   -47.695103 0.0034851739            1            1 
    5150    260.19047    29.046394 0.0034851739            1            1 
    5200     239.8355   -5.4890372 0.0034851739            1            1 
    5250    234.88522   -18.172649 0.0034851739            1            1 
    5300    236.43278   -39.062111 0.0034851739            1            1 
    5350    280.90083   -2.6932604 0.0034851739            1            1 
    5400    316.65269    23.071363 0.0034851739            1            1 
    5450     345.6322    19.573305 0.0034851739            1            1 
    5500    384.57334     41.50729 0.0034851739            1            1 
    5550    317.14286    9.6992981 0.0034851739            1            1 
    5600    279.93246   -12.076859 0.0034851739            1            1 
    5650    268.06471    1.6196502 0.0034851739            1            1 
    5700    271.85714   -40.378489 0.0034851739            1            1 
    5750    313.88361    10.722652 0.0034851739            1            1 
    5800    281.54499    31.914883 0.0034851739            1            1 
    5850    293.34819   -8.3155887 0.0034851739            1            1 
    5900    249.25215   -17.307228 0.0034851739            1            1 
    5950    268.18645   -4.7223601 0.0034851739            1            1 
    6000    302.99402   -52.615432 0.0034851739            1            1 
    6050    314.57946    34.513152 0.0034851739            1            1 
    6100    345.70342     30.33474 0.0034851739            1            1 
    6150    316.59329    31.862566 0.0034851739            1            1 
    6200    317.85341    -32.23511 0.0034851739            1            1 
    6250    282.97674   0.29367434 0.0034851739            1            1 
    6300    267.91823    19.265617 0.0034851739            1            1 
    6350     226.2098   -13.093573 0.0034851739            1            1 
    6400    307.73307    17.439662 0.0034851739            1            1 
    6450    292.16311   -23.275251 0.0034851739            1            1 
    6500    335.05972    26.936588 0.0034851739            1            1 
    6550     380.7351    19.532324 0.0034851739            1            1 
    6600    373.01041    30.879146 0.0034851739            1            1 
    6650    335.37897   -2.1766711 0.0034851739            1            1 
    6700    298.94275   -10.578361 0.0034851739            1            1 
    6750    255.11449   -50.575851 0.0034851739            1            1 
    6800    222.87598    3.0488985 0.0034851739            1            1 
    6850    268.57268   -43.676136 0.0034851739            1            1 
    6900    260.30442    4.7484508 0.0034851739            1            1 
    6950    289.15739    31.622589 0.0034851739            1            1 
    7000    289.11733    21.636361 0.0034851739            1            1 
    7050    361.08905    22.442487 0.0034851739            1            1 
    7100    368.95006    4.8393179 0.0034851739            1            1 
    7150    331.47878   -36.202032 0.0034851739            1            1 
    7200    304.72518    13.982604 0.0034851739            1            1 
    7250     284.0996   0.53900966 0.0034851739            1            1 
    7300    269.17156   -41.572215 0.0034851739            1            1 
    7350    222.06563     25.56579 0.0034851739            1            1 
    7400    304.09479     15.48238 0.0034851739            1            1 
    7450    298.79046   -7.4369454 0.0034851739            1            1 
    7500    328.78217    14.672853 0.0034851739            1            1 
    7550    347.06589   -37.168123 0.0034851739            1            1 
    7600    362.84157    20.514912 0.0034851739            1            1 
    7650    347.15916    2.3477485 0.0034851739            1            1 
    7700    262.09822    33.901831 0.0034851739            1            1 
    7750    275.85921   -33.536059 0.0034851739            1            1 
    7800    281.16159   -18.288414 0.0034851739            1            1 
    7850    264.83553   -30.566284 0.0034851739            1            1 
    7900    257.35224   -35.087067 0.0034851739            1            1 
    7950    286.30756    26.586163 0.0034851739            1            1 
    8000    248.38175    15.601961 0.0034851739            1            1 
    8050    292.59171    28.784541 0.0034851739            1            1 
    8100    312.52852   0.87995053 0.0034851739            1            1 
    8150    285.62346   -15.337252 0.0034851739            1            1 
    8200    292.24175   -38.192576 0.0034851739            1            1 
    8250    321.61618   -19.030398 0.0034851739            1            1 
    8300    319.42189    55.078305 0.0034851739            1            1 
    8350    308.00357    32.050518 0.0034851739            1            1 
    8400    345.68186    8.7983733 0.0034851739            1            1 
    8450    358.00849    12.434592 0.0034851739            1            1 
    8500    370.14359    4.2184721 0.0034851739            1            1 
    8550     360.6511    12.580836 0.0034851739            1            1 
    8600    290.04938   -4.8422589 0.0034851739            1            1 
    8650    297.95745   -5.3185591 0.0034851739            1            1 
    8700    286.54284   -31.490479 0.0034851739            1            1 
    8750    308.08791     19.24417 0.0034851739            1            1 
    8800    231.72534    12.262217 0.0034851739            1            1 
    8850     329.2349   -8.9133933 0.0034851739            1            1 
    8900    287.64023    10.525164 0.0034851739            1            1 
    8950    341.08296      2.80127 0.0034851739            1            1 
    9000    403.71266     17.88418 0.0034851739            1            1 
    9050    348.95132   -4.5813611 0.0034851739            1            1 
    9100    307.98322    16.707575 0.0034851739            1            1 
    9150    276.75719   -35.563923 0.0034851739            1            1 
    9200    230.15547    3.8091656 0.0034851739            1            1 
    9250    264.64479    -20.97438 0.0034851739            1            1 
    9300    285.70467    13.881735 0.0034851739            1            1 
    9350      297.515    13.599319 0.0034851739            1            1 
    9400    341.45203   -28.494544 0.0034851739            1            1 
    9450    319.29703   -27.907344 0.0034851739            1            1 
    9500    332.50473    4.9891138 0.0034851739            1            1 
    9550    293.10499   -8.3244772 0.0034851739            1            1 
    9600    255.31174    2.2568315 0.0034851739            1            1 
    9650    250.01932    5.7005159 0.0034851739            1            1 
    9700    278.37409   -8.5970424 0.0034851739            1            1 
    9750    294.86737    17.686447 0.0034851739            1            1 
    9800    277.07345   -2.0856886 0.0034851739            1            1 
    9850    295.54707    2.8365471 0.0034851739            1            1 
    9900    311.51074    29.885116 0.0034851739            1            1 
    9950    296.01363    12.206068 0.0034851739            1            1 
   10000    341.35187   -3.0045464 0.0034851739            1            1 
Loop time of 3.64332 on 4 procs for 10000 steps with 44 atoms

Performance: 237.146 ns/day, 0.101 hours/ns, 2744.751 timesteps/s
94.5% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0029962  | 0.10426    | 0.34564    |  43.9 |  2.86
Bond    | 0.005929   | 0.29803    | 0.95305    |  71.2 |  8.18
Kspace  | 0.83969    | 1.5992     | 1.9344     |  35.6 | 43.89
Neigh   | 0.65468    | 0.66443    | 0.67431    |   0.9 | 18.24
Comm    | 0.1727     | 0.23754    | 0.2745     |   8.0 |  6.52
Output  | 0.0048738  | 0.010774   | 0.028434   |   9.8 |  0.30
Modify  | 0.62478    | 0.70376    | 0.779      |   6.5 | 19.32
Other   |            | 0.02531    |            |       |  0.69

Nlocal:    11 ave 40 max 0 min
Histogram: 2 1 0 0 0 0 0 0 0 1
Nghost:    36 ave 47 max 7 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:    203 ave 809 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 812
Ave neighs/atom = 18.4545
Ave special neighs/atom = 9.77273
Neighbor list builds = 10000
Dangerous builds = 0

# write_restart restart_longrun
# write_data restart_longrun.data
Total wall time: 0:00:03
