LAMMPS (29 Jun 2018)
# 2d rounded polygon bodies

variable    r     index 4
variable    steps index 100000
variable    T     index 0.5
variable    P     index 0.1
variable    seed  index 980411

units       lj
dimension   2

atom_style  body rounded/polygon 1 6
atom_modify map array
read_data   data.squares
  orthogonal box = (0 0 -0.5) to (12 12 0.5)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  2 atoms
  2 bodies

replicate   $r $r 1
replicate   4 $r 1
replicate   4 4 1
  orthogonal box = (0 0 -0.5) to (48 48 0.5)
  1 by 1 by 1 MPI processor grid
  32 atoms
  Time spent = 0.00020504 secs

velocity    all create $T ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 980411 dist gaussian mom yes rot yes

variable cut_inner  equal 0.5
variable k_n        equal 100
variable k_na       equal 2
variable c_n        equal 1
variable c_t        equal 1
variable mu         equal 0.1
variable delta_ua   equal 0.5

pair_style body/rounded/polygon ${c_n} ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 0.5 ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 0.5 0.5
pair_coeff * * ${k_n} ${k_na}
pair_coeff * * 100 ${k_na}
pair_coeff * * 100 2

comm_modify vel yes

neighbor     0.5 bin
neigh_modify every 1 delay 0 check yes

timestep     0.001

#fix         1 all nve/body
#fix         1 all nvt/body temp $T $T 1.0
fix          1 all npt/body temp $T $T 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 $T 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0              y 0.001 0.1 1.0 couple xy fixedpoint 0 0 0

fix          2 all enforce2d

#compute      1 all body/local id 1 2 3
#dump         1 all local 100000 dump.polygon.* index c_1[1] c_1[2] c_1[3] c_1[4]

thermo_style custom step ke pe etotal press
thermo       1000

#dump	     2 all image 10000 image.*.jpg type type zoom 2.0 #             adiam 1.5 body type 0 0
#dump_modify  2 pad 6

run          ${steps}
run          100000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.15685
  ghost atom cutoff = 6.15685
  binsize = 3.07843, bins = 16 16 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair body/rounded/polygon, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d/newton
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.781 | 4.781 | 4.781 Mbytes
Step KinEng PotEng TotEng Press 
       0     0.484375         0.25     0.734375 0.0067274306 
    1000   0.39423376 0.0017918048   0.39602557 0.0021941612 
    2000   0.42284177   0.01346585   0.43630762 0.0029377883 
    3000   0.58154405  0.011321689   0.59286574  0.003667871 
    4000   0.73518304  0.034603175   0.76978621 0.0018689207 
    5000   0.84367476  0.025292163   0.86896692 0.0089161373 
    6000   0.70803236 0.0085631016   0.71659546 0.0045552895 
    7000   0.56206452   0.10453031   0.66659483  0.010255161 
    8000   0.64538994  0.088817673   0.73420761 0.0037633655 
    9000   0.90540819  0.063696004   0.96910419 0.0077673359 
   10000   0.68632042  0.093265016   0.77958544 0.0057864838 
   11000   0.59118074  0.025654748   0.61683549  0.012518759 
   12000   0.67522767  0.038176401   0.71340407   0.01741153 
   13000    0.7644843   0.10429844   0.86878274  0.013161339 
   14000   0.56152694  0.067836655   0.62936359  0.016852121 
   15000   0.41895506  0.019513348   0.43846841  0.015225695 
   16000   0.55799421    0.1564559   0.71445011  0.011703561 
   17000   0.59391964  0.034450221   0.62836986  0.026215002 
   18000   0.75911858  0.030885726    0.7900043  0.018396366 
   19000   0.64417995   0.12110912   0.76528907  0.010247952 
   20000   0.57751435   0.16965651   0.74717086  0.023392323 
   21000    0.7613368   0.13405354   0.89539034  0.021498982 
   22000   0.57676692   0.18011879   0.75688571  0.024469161 
   23000   0.54043723   0.11842026   0.65885749  0.019799067 
   24000   0.62276061  0.038967924   0.66172853  0.019080086 
   25000   0.53157536   0.11651937   0.64809473  0.017019298 
   26000   0.72213293  0.039012448   0.76114538  0.015434904 
   27000   0.62157832   0.13697494   0.75855326  0.028711011 
   28000   0.41323738   0.16301101   0.57624839  0.041792632 
   29000   0.45774328   0.17569066   0.63343394  0.019975231 
   30000   0.78901796  0.099791386   0.88880934  0.024116947 
   31000   0.85205397   0.11977547   0.97182945  0.026667489 
   32000   0.37137095    0.1232622   0.49463315 0.00087637364 
   33000   0.26860871   0.26056381   0.52917252  0.036110517 
   34000    0.3018636   0.21336905   0.51523265  0.040315549 
   35000   0.39915129   0.28245957   0.68161085  0.034876856 
   36000   0.25761236    0.2352705   0.49288286  0.022772767 
   37000    0.1071233   0.31692858   0.42405188  0.017994666 
   38000  0.083729577   0.28473145   0.36846103 -0.0045370431 
   39000  0.070355565   0.26682083   0.33717639  0.017921556 
   40000  0.075894079   0.20077896   0.27667304  0.014873186 
   41000   0.05891028   0.15989064   0.21880092  0.025547873 
   42000    0.1225107   0.16583605   0.28834675  0.038842785 
   43000   0.17049189   0.14323991    0.3137318  0.029550161 
   44000   0.26823939   0.15208257   0.42032196  0.028113612 
   45000   0.10172203    0.1729706   0.27469264 -0.013769913 
   46000   0.14841355   0.19085074   0.33926429 -0.00073741985 
   47000   0.27654927   0.19097937   0.46752864   0.04021431 
   48000   0.53432331  0.080769923   0.61509323  0.029932845 
   49000   0.69111634   0.13064951   0.82176585  0.028985406 
   50000   0.24520806   0.18317453   0.42838258   0.05179746 
   51000   0.23541368   0.14281364   0.37822732  0.071884238 
   52000   0.25464996  0.095730242    0.3503802  0.034488204 
   53000   0.53677633    0.1058745   0.64265084  0.059932498 
   54000   0.32970921   0.27979128   0.60950049  0.062869716 
   55000   0.49094054  0.096735015   0.58767556   0.04728005 
   56000   0.54398249    0.2216472   0.76562969  0.056712022 
   57000   0.60869068    0.2338422   0.84253288  0.077143302 
   58000   0.72175509   0.18687368   0.90862877  0.019357656 
   59000   0.79442757  0.092502981   0.88693055  0.066882632 
   60000    0.6810555  0.077699385   0.75875488  0.095975173 
   61000   0.63178834   0.05071143   0.68249977  0.043586668 
   62000   0.76589344  0.044615704   0.81050914  0.085718411 
   63000   0.84815889  0.030527848   0.87868674  0.053072795 
   64000    0.7309043  0.051938637   0.78284294  0.058887766 
   65000   0.62498816  0.034474465   0.65946262  0.068446407 
   66000   0.69817494  0.068546004   0.76672094  0.062634433 
   67000   0.86444275  0.010184259   0.87462701  0.073635055 
   68000   0.77820319 0.0079319524   0.78613515  0.090330925 
   69000   0.56938919 0.0092629332   0.57865213  0.061838729 
   70000   0.61870712  0.010047381    0.6287545  0.066501338 
   71000   0.71651803 0.0088366199   0.72535465  0.079136316 
   72000   0.76278925  0.008828151   0.77161741  0.063672771 
   73000   0.75447428 0.0083985526   0.76287283  0.078256913 
   74000   0.66185251 0.0091910052   0.67104351  0.069840511 
   75000   0.58458829 0.0097671568   0.59435544  0.076123422 
   76000    0.7487564    0.0100022    0.7587586  0.076171741 
   77000   0.89505465  0.009250681   0.90430533  0.074921699 
   78000   0.73738164 0.0092029279   0.74658457  0.078835344 
   79000   0.65735281  0.010099528   0.66745233  0.077940627 
   80000   0.70247542  0.010306464   0.71278189  0.079560093 
   81000   0.74839505  0.010199092   0.75859415  0.080835104 
   82000   0.75193767  0.010274058   0.76221173  0.081086684 
   83000   0.71392598  0.010495573   0.72442156  0.082746145 
   84000   0.58498928  0.011027388   0.59601667   0.08356465 
   85000   0.59022869  0.011729474   0.60195817  0.084519397 
   86000   0.81753578  0.011208964   0.82874475  0.085490261 
   87000   0.83480682  0.010542579    0.8453494  0.086268527 
   88000   0.67322538  0.011170734   0.68439611   0.08751623 
   89000   0.62637389  0.012033316    0.6384072  0.088548094 
   90000   0.92828557  0.011750388   0.94003596  0.089199823 
   91000   0.96072564  0.010324509   0.97105015  0.090204803 
   92000   0.72105071  0.011484152   0.73253486   0.09140819 
   93000   0.65762527  0.012558219   0.67018349  0.092453474 
   94000   0.73991591   0.01261909     0.752535  0.093373477 
   95000   0.91791653  0.011980455   0.92989699  0.094182136 
   96000   0.76562561  0.011807085    0.7774327  0.095323684 
   97000   0.57292104  0.013610205   0.58653124  0.096505977 
   98000   0.68141076  0.013863204   0.69527396  0.097380069 
   99000   0.82390969  0.013002341   0.83691203  0.098235926 
  100000   0.77639728  0.012989342   0.78938662  0.099274147 
Loop time of 3.88899 on 1 procs for 100000 steps with 32 atoms

Performance: 2221655.884 tau/day, 25713.610 timesteps/s
99.9% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.056      | 3.056      | 3.056      |   0.0 | 78.58
Neigh   | 0.0051048  | 0.0051048  | 0.0051048  |   0.0 |  0.13
Comm    | 0.091444   | 0.091444   | 0.091444   |   0.0 |  2.35
Output  | 0.0011995  | 0.0011995  | 0.0011995  |   0.0 |  0.03
Modify  | 0.69909    | 0.69909    | 0.69909    |   0.0 | 17.98
Other   |            | 0.03616    |            |       |  0.93

Nlocal:    32 ave 32 max 32 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    21 ave 21 max 21 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    57 ave 57 max 57 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 57
Ave neighs/atom = 1.78125
Neighbor list builds = 1445
Dangerous builds = 0
Total wall time: 0:00:03
