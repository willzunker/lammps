LAMMPS (29 Jun 2018)
# 2d rounded polygon bodies

variable    r     index 4
variable    steps index 100000
variable    T     index 0.5
variable    P     index 0.1
variable    seed  index 980411

units       lj
dimension   2

atom_style  body rounded/polygon 1 6
atom_modify map array
read_data   data.squares
  orthogonal box = (0 0 -0.5) to (12 12 0.5)
  2 by 2 by 1 MPI processor grid
  reading atoms ...
  2 atoms
  2 bodies

replicate   $r $r 1
replicate   4 $r 1
replicate   4 4 1
  orthogonal box = (0 0 -0.5) to (48 48 0.5)
  2 by 2 by 1 MPI processor grid
  32 atoms
  Time spent = 0.000324011 secs

velocity    all create $T ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 980411 dist gaussian mom yes rot yes

variable cut_inner  equal 0.5
variable k_n        equal 100
variable k_na       equal 2
variable c_n        equal 1
variable c_t        equal 1
variable mu         equal 0.1
variable delta_ua   equal 0.5

pair_style body/rounded/polygon ${c_n} ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 0.5 ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 0.5 0.5
pair_coeff * * ${k_n} ${k_na}
pair_coeff * * 100 ${k_na}
pair_coeff * * 100 2

comm_modify vel yes

neighbor     0.5 bin
neigh_modify every 1 delay 0 check yes

timestep     0.001

#fix         1 all nve/body
#fix         1 all nvt/body temp $T $T 1.0
fix          1 all npt/body temp $T $T 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 $T 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0              y 0.001 0.1 1.0 couple xy fixedpoint 0 0 0

fix          2 all enforce2d

#compute      1 all body/local id 1 2 3
#dump         1 all local 100000 dump.polygon.* index c_1[1] c_1[2] c_1[3] c_1[4]

thermo_style custom step ke pe etotal press
thermo       1000

#dump	     2 all image 10000 image.*.jpg type type zoom 2.0 #             adiam 1.5 body type 0 0
#dump_modify  2 pad 6

run          ${steps}
run          100000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.15685
  ghost atom cutoff = 6.15685
  binsize = 3.07843, bins = 16 16 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair body/rounded/polygon, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d/newton
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.774 | 4.774 | 4.774 Mbytes
Step KinEng PotEng TotEng Press 
       0     0.484375         0.25     0.734375 0.0067274306 
    1000   0.39423376 0.0017918048   0.39602557 0.0021941612 
    2000   0.42284177   0.01346585   0.43630762 0.0029377883 
    3000   0.58154405  0.011321689   0.59286574  0.003667871 
    4000   0.73518304  0.034603175   0.76978621 0.0018689207 
    5000   0.84367476  0.025292163   0.86896692 0.0089161373 
    6000   0.70803236 0.0085631016   0.71659546 0.0045552895 
    7000   0.56206452   0.10453031   0.66659483  0.010255161 
    8000   0.64538994  0.088817673   0.73420761 0.0037633655 
    9000   0.90540819  0.063696004   0.96910419 0.0077673359 
   10000   0.68632042  0.093265016   0.77958544 0.0057864837 
   11000   0.59118074  0.025654748   0.61683549  0.012518759 
   12000   0.67522767  0.038176401   0.71340407   0.01741153 
   13000    0.7644843   0.10429844   0.86878274  0.013161339 
   14000   0.56152694  0.067836656    0.6293636  0.016852113 
   15000   0.41895505  0.019513353   0.43846841  0.015225696 
   16000   0.55799443   0.15645637    0.7144508  0.011703646 
   17000   0.59385248   0.03451986   0.62837234  0.025482966 
   18000   0.75902169  0.031103586   0.79012527  0.018263354 
   19000   0.64266826   0.12535314   0.76802141  0.014884119 
   20000   0.57836261   0.16581188   0.74417449  0.024667165 
   21000   0.78281936   0.11877527   0.90159464 -0.0090089213 
   22000    0.5312006   0.13300874   0.66420934  0.025797278 
   23000   0.56458861  0.084369128   0.64895774  0.024630917 
   24000   0.65126875   0.06122992   0.71249867  0.034377198 
   25000   0.55173441   0.15694886   0.70868327  0.021634086 
   26000   0.59121615   0.17071182   0.76192797  0.024758366 
   27000    0.6394843   0.17442949   0.81391378  0.034919937 
   28000   0.31144221   0.41243036   0.72387256  0.074115225 
   29000   0.13516917    0.3075419   0.44271107  0.023861298 
   30000   0.14094934   0.24407203   0.38502137  0.037030438 
   31000   0.26313749  0.087395422   0.35053291  0.042347005 
   32000   0.51602457  0.063012079   0.57903664  0.018550299 
   33000   0.55628829     0.200213   0.75650129  0.026507686 
   34000   0.97399408  0.082504517    1.0564986  0.037889878 
   35000   0.64710533   0.17662002   0.82372535  0.058295508 
   36000   0.45769083   0.08241194   0.54010277  0.014957415 
   37000   0.72850105  0.053874061   0.78237512  0.037194593 
   38000   0.44177995   0.28939498   0.73117493  0.045194029 
   39000   0.46828451  0.077630686   0.54591519  0.089849009 
   40000   0.46786451  0.092828423   0.56069294  0.028042052 
   41000   0.71861856  0.097085715   0.81570427  0.036473296 
   42000   0.74121021   0.10553127   0.84674148  0.054058843 
   43000   0.62945489   0.12770673   0.75716161  0.047267994 
   44000   0.49900638  0.085150056   0.58415644  0.054798793 
   45000   0.70199572  0.063415877    0.7654116  0.038363546 
   46000   0.49513142   0.10649384   0.60162526  0.059392561 
   47000    0.3858898  0.079458749   0.46534855  0.051825764 
   48000   0.62585854  0.028585902   0.65444444  0.054074424 
   49000   0.65934482   0.51865062    1.1779954 -0.035272836 
   50000    0.5420438  0.082056756   0.62410056  0.031187494 
   51000   0.36685223   0.14224019   0.50909241  0.073790397 
   52000   0.19044627   0.15368389   0.34413016  0.059034266 
   53000   0.26847678  0.075693324    0.3441701  0.032276915 
   54000    0.3593711   0.19034549   0.54971659  0.070827883 
   55000   0.21659198    0.1929074   0.40949939  0.035916364 
   56000   0.28242715   0.12313241   0.40555956  0.062083926 
   57000   0.34067475   0.14711992   0.48779467  0.059321458 
   58000    0.4842796   0.16143425   0.64571385  0.059048247 
   59000   0.84438871  0.076546849   0.92093556  0.048046901 
   60000   0.92794849  0.054331626   0.98228012  0.058392272 
   61000    0.6916736  0.076168342   0.76784194  0.058654987 
   62000   0.63317965  0.094506389   0.72768604  0.061044719 
   63000   0.63317266  0.038785593   0.67195825  0.097236147 
   64000   0.81696668     0.121811   0.93877769  0.064935373 
   65000   0.82644758   0.25188344     1.078331  0.093352359 
   66000   0.64975019   0.17930857   0.82905876  0.058805254 
   67000   0.63487678   0.16877059   0.80364737  0.070254696 
   68000   0.79140717   0.11631004    0.9077172  0.064646394 
   69000   0.85687272  0.057835331   0.91470805  0.071057291 
   70000   0.67785976  0.040686768   0.71854653  0.074687222 
   71000   0.60594577  0.032193155   0.63813893  0.069349268 
   72000   0.77586745  0.024068533   0.79993598  0.083394193 
   73000   0.88877625  0.025746326   0.91452258  0.081511105 
   74000   0.73507888  0.036574786   0.77165367  0.075360233 
   75000   0.68787782  0.042098622   0.72997644  0.068651098 
   76000   0.72515745   0.04360868   0.76876613  0.069594624 
   77000   0.77580944  0.041826702   0.81763614  0.071937144 
   78000   0.76640394  0.039285046   0.80568899  0.074274921 
   79000   0.62504309  0.039593585   0.66463667  0.076443295 
   80000   0.60001642  0.043468215   0.64348464  0.094547719 
   81000   0.82175037  0.045608873   0.86735924  0.080186295 
   82000   0.85783276  0.042692576   0.90052534  0.081576548 
   83000   0.71367707  0.042172193   0.75584926   0.08256625 
   84000   0.68532406  0.044724759   0.73004882  0.083672013 
   85000   0.72576789  0.046982462   0.77275035  0.084789331 
   86000   0.75597701   0.04765086   0.80362787  0.085758056 
   87000   0.74190598  0.047629096   0.78953507  0.086679976 
   88000   0.60967704  0.049906172   0.65958321  0.085526191 
   89000   0.54490288  0.054768238   0.59967112  0.090604027 
   90000   0.75398341  0.057153453   0.81113686  0.091900858 
   91000   0.84577472  0.052753512   0.89852823  0.091913909 
   92000    0.7176235  0.050677427   0.76830093  0.092032507 
   93000   0.61699446  0.054097013   0.67109147  0.092071275 
   94000   0.76330752  0.057398618   0.82070614  0.092435043 
   95000   0.98754458  0.053801311    1.0413459  0.093526707 
   96000    0.7405897  0.052135628   0.79272533  0.095011929 
   97000   0.65587599  0.057011962   0.71288795  0.096692123 
   98000   0.72345634  0.060700171   0.78415651  0.097510345 
   99000   0.88283624  0.061795247   0.94463149   0.09799633 
  100000   0.86303812  0.058912988   0.92195111   0.09892993 
Loop time of 2.80074 on 4 procs for 100000 steps with 32 atoms

Performance: 3084895.573 tau/day, 35704.810 timesteps/s
99.9% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.81169    | 0.89466    | 0.97669    |   8.4 | 31.94
Neigh   | 0.0017524  | 0.0018129  | 0.0018773  |   0.1 |  0.06
Comm    | 0.91307    | 0.99193    | 1.0691     |   7.3 | 35.42
Output  | 0.00076914 | 0.00093722 | 0.0013936  |   0.0 |  0.03
Modify  | 0.75335    | 0.75779    | 0.76346    |   0.4 | 27.06
Other   |            | 0.1536     |            |       |  5.48

Nlocal:    8 ave 10 max 4 min
Histogram: 1 0 0 0 0 0 1 0 0 2
Nghost:    17.25 ave 19 max 15 min
Histogram: 1 0 1 0 0 0 0 0 0 2
Neighs:    13.5 ave 21 max 5 min
Histogram: 1 0 0 0 1 0 1 0 0 1

Total # of neighbors = 54
Ave neighs/atom = 1.6875
Neighbor list builds = 1443
Dangerous builds = 0
Total wall time: 0:00:02
