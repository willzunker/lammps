LAMMPS (29 Jun 2018)
# 2d rounded polygon bodies

variable    r     index 4
variable    steps index 100000
variable    T     index 0.5
variable    P     index 0.1
variable    seed  index 980411

units       lj
dimension   2

atom_style  body rounded/polygon 1 6
atom_modify map array
read_data   data.squares
  orthogonal box = (0 0 -0.5) to (12 12 0.5)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  2 atoms
  2 bodies

replicate   $r $r 1
replicate   4 $r 1
replicate   4 4 1
  orthogonal box = (0 0 -0.5) to (48 48 0.5)
  1 by 1 by 1 MPI processor grid
  32 atoms
  Time spent = 0.00029707 secs

velocity    all create $T ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 980411 dist gaussian mom yes rot yes

change_box  all boundary p f p

variable cut_inner  equal 0.5
variable k_n        equal 100
variable k_na       equal 2
variable c_n        equal 0.1
variable c_t        equal 0.1
variable mu         equal 0.1
variable delta_ua   equal 0.5

pair_style body/rounded/polygon ${c_n} ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 0.5 ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 0.5 0.5
pair_coeff * * ${k_n} ${k_na}
pair_coeff * * 100 ${k_na}
pair_coeff * * 100 2

comm_modify vel yes

neighbor     0.5 bin
neigh_modify every 1 delay 0 check yes

timestep     0.001

#fix         1 all nve/body
#fix         1 all nvt/body temp $T $T 1.0
fix          1 all npt/body temp $T $T 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 $T 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0 fixedpoint 0 0 0

fix          2 all enforce2d
fix          3 all wall/body/polygon 2000 50 50 yplane 0.0 48.0

#compute      1 all body/local id 1 2 3
#dump         1 all local 100000 dump.polygon.* index c_1[1] c_1[2] c_1[3] c_1[4]

thermo_style custom step ke pe etotal press
thermo       1000

#dump	     2 all image 10000 image.*.jpg type type zoom 2.0 #             adiam 1.5 body type 0 0
#dump_modify  2 pad 6

run          ${steps}
run          100000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.15685
  ghost atom cutoff = 6.15685
  binsize = 3.07843, bins = 16 16 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair body/rounded/polygon, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d/newton
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.771 | 4.771 | 4.771 Mbytes
Step KinEng PotEng TotEng Press 
       0     0.484375         0.25     0.734375 0.0067274306 
    1000   0.49241101 0.0031318767   0.49554289  0.017768281 
    2000   0.56118632 0.0026068888   0.56379321  0.003410416 
    3000   0.75565115  0.025578366   0.78122951 0.0071862988 
    4000   0.72298647  0.093150646   0.81613712  0.003190158 
    5000   0.51684166  0.049164868   0.56600653 0.0096960168 
    6000   0.56627905  0.048132853    0.6144119  0.020733586 
    7000   0.58122129  0.018223718   0.59944501 0.0038160759 
    8000   0.64297977  0.025934821   0.66891459 0.0041091784 
    9000   0.41748404 0.0077890042   0.42527305 0.0039270065 
   10000   0.35738377  0.078487805   0.43587158 3.9079782e-05 
   11000   0.41529308   0.13619284   0.55148592 -0.0067482285 
   12000   0.43274718  0.071315497   0.50406268  0.007006378 
   13000    0.4748331  0.069904647   0.54473775 0.0010384372 
   14000    0.6287791   0.12721033   0.75598943 0.0047792448 
   15000    0.4692413   0.12344005   0.59268136  0.018033616 
   16000   0.43157074   0.14306789   0.57463862  0.042356676 
   17000   0.53085999   0.22126296   0.75212294  0.027509646 
   18000   0.52688968   0.13225282    0.6591425 0.0021558013 
   19000   0.55032328   0.12513047   0.67545375  0.025036251 
   20000   0.48465097    0.1431055   0.62775647  0.017193781 
   21000   0.53166734   0.21928574   0.75095307  0.011564317 
   22000   0.62177353   0.09296159   0.71473512  0.017660922 
   23000    0.6972939   0.12434123   0.82163514  0.024432327 
   24000   0.42767372   0.22152311   0.64919684 -0.013712449 
   25000    0.4816037   0.19272865   0.67433236  0.052386055 
   26000   0.72642579   0.19697046   0.92339625  0.020407694 
   27000   0.39649144   0.15058326    0.5470747  0.023705766 
   28000   0.44896324   0.18500106    0.6339643 -0.0089410286 
   29000    0.5565759   0.11085772   0.66743362  0.048437166 
   30000   0.58173584   0.21773281   0.79946865 0.0057357773 
   31000   0.49199415   0.23601982   0.72801397  0.046744152 
   32000   0.55665496   0.20542161   0.76207658 -0.0038756805 
   33000   0.62730739   0.24460524   0.87191263  0.045330682 
   34000   0.58107044   0.16395278   0.74502322 -0.0049496051 
   35000   0.56838849   0.21842922   0.78681771 0.0062086036 
   36000   0.45910273   0.28464172   0.74374445 -0.011700747 
   37000   0.37092037   0.27646862     0.647389  0.022305679 
   38000    0.7278047   0.30674438    1.0345491   0.07698342 
   39000    0.5132923   0.27395066   0.78724295  0.026898634 
   40000   0.62348649   0.24424644   0.86773293  0.039403899 
   41000    0.3658401   0.15512326   0.52096337  0.022559003 
   42000    0.4912253   0.35712978   0.84835508 -0.010336341 
   43000   0.70225957   0.36314638    1.0654059  0.004148866 
   44000   0.56958157   0.25488927   0.82447084  0.067537066 
   45000   0.45854352   0.30149439   0.76003791 -0.017002401 
   46000   0.62787247   0.34567995   0.97355242   0.11894801 
   47000   0.61348914   0.29378625   0.90727539  0.067873976 
   48000   0.71301829   0.34135284    1.0543711  0.021077736 
   49000   0.53520804   0.30593196   0.84113999 0.0059257647 
   50000   0.44966403   0.35370793   0.80337195 0.0020395669 
   51000    0.5236113   0.32296924   0.84658054 -0.051011506 
   52000   0.53905573     0.351771   0.89082672  0.013720106 
   53000   0.55978158   0.41293947   0.97272106  0.068558589 
   54000   0.52170459    0.2718066    0.7935112 0.0093138985 
   55000   0.61078876   0.43353897    1.0443277  0.045377392 
   56000   0.51300655   0.33182278   0.84482933 -0.018418487 
   57000   0.54882822   0.38380093   0.93262915   0.10249946 
   58000   0.72106212   0.45361279    1.1746749  0.030313481 
   59000   0.55871447   0.63823029    1.1969448  0.019079703 
   60000   0.49395192   0.58283102    1.0767829    0.0179349 
   61000   0.45991079   0.62540573    1.0853165  0.074398804 
   62000    0.4655788   0.60862262    1.0742014   0.11472976 
   63000   0.55634524   0.63069255    1.1870378 -0.0025676135 
   64000   0.57688903   0.45435264    1.0312417 0.0083813852 
   65000   0.57168922   0.42217005   0.99385927  0.044931269 
   66000    0.6206044   0.46727538    1.0878798  0.019686229 
   67000   0.61037155   0.41840109    1.0287726    0.0195109 
   68000   0.63848598   0.41305347    1.0515395  0.072940144 
   69000   0.49244916    0.3834095   0.87585866   0.07963677 
   70000   0.41847062   0.51907975   0.93755037   0.18447904 
   71000   0.45198986   0.52973709   0.98172695  0.078419371 
   72000   0.47064262   0.37808165   0.84872427 -0.00046308054 
   73000    0.6690143   0.37549359    1.0445079  0.061208432 
   74000   0.60444955   0.33779636   0.94224592 -0.068840321 
   75000   0.61762382    0.3916421    1.0092659   0.16253292 
   76000   0.63657961   0.50277989    1.1393595  0.013857508 
   77000   0.52524028   0.43597896   0.96121924  -0.03296482 
   78000   0.43803533   0.33172284   0.76975817  0.078763029 
   79000   0.67156089   0.55272177    1.2242827  0.080822223 
   80000   0.68678238   0.46061627    1.1473987 0.0027036992 
   81000   0.64956678   0.44959229    1.0991591   0.11201483 
   82000   0.51060477   0.43508342    0.9456882  0.028000608 
   83000   0.59550548   0.69026083    1.2857663 -0.0015809004 
   84000   0.64222145   0.38768816    1.0299096  0.014153173 
   85000    0.7661229   0.43445261    1.2005755  0.048034534 
   86000   0.60025257   0.53027929    1.1305319 0.0056865157 
   87000   0.46220939   0.47470035   0.93690974  0.075311946 
   88000   0.54123847   0.62899839    1.1702369   0.13260162 
   89000   0.61212272    0.6114241    1.2235468  0.033284822 
   90000   0.63924773    0.6916249    1.3308726  0.045088296 
   91000   0.49316865   0.51037033     1.003539  0.023203598 
   92000   0.57572123   0.43496319    1.0106844     0.297092 
   93000   0.65187559   0.56815972    1.2200353    0.1538215 
   94000   0.64107331   0.58948521    1.2305585  0.031117778 
   95000   0.64584158    0.6364688    1.2823104  0.096154676 
   96000   0.60509093     0.601487    1.2065779   0.03457172 
   97000   0.68837218   0.77974186     1.468114   0.17801164 
   98000   0.62725266   0.64137144    1.2686241   0.17449001 
   99000   0.46861221   0.67000291    1.1386151    0.2429588 
  100000    0.5879119    0.7140612    1.3019731  0.064634257 
Loop time of 2.50594 on 1 procs for 100000 steps with 32 atoms

Performance: 3447804.126 tau/day, 39905.140 timesteps/s
100.0% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.5639     | 1.5639     | 1.5639     |   0.0 | 62.41
Neigh   | 0.0086911  | 0.0086911  | 0.0086911  |   0.0 |  0.35
Comm    | 0.058926   | 0.058926   | 0.058926   |   0.0 |  2.35
Output  | 0.0012379  | 0.0012379  | 0.0012379  |   0.0 |  0.05
Modify  | 0.83537    | 0.83537    | 0.83537    |   0.0 | 33.34
Other   |            | 0.03781    |            |       |  1.51

Nlocal:    32 ave 32 max 32 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    20 ave 20 max 20 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    57 ave 57 max 57 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 57
Ave neighs/atom = 1.78125
Neighbor list builds = 2705
Dangerous builds = 0
Total wall time: 0:00:02
