LAMMPS (29 Jun 2018)
# 2d rounded polygon bodies

variable    r     index 4
variable    steps index 100000
variable    T     index 0.5
variable    P     index 0.1
variable    seed  index 980411

units       lj
dimension   2

atom_style  body rounded/polygon 1 6
atom_modify map array
read_data   data.squares
  orthogonal box = (0 0 -0.5) to (12 12 0.5)
  2 by 2 by 1 MPI processor grid
  reading atoms ...
  2 atoms
  2 bodies

replicate   $r $r 1
replicate   4 $r 1
replicate   4 4 1
  orthogonal box = (0 0 -0.5) to (48 48 0.5)
  2 by 2 by 1 MPI processor grid
  32 atoms
  Time spent = 0.000386 secs

velocity    all create $T ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 980411 dist gaussian mom yes rot yes

change_box  all boundary p f p

variable cut_inner  equal 0.5
variable k_n        equal 100
variable k_na       equal 2
variable c_n        equal 0.1
variable c_t        equal 0.1
variable mu         equal 0.1
variable delta_ua   equal 0.5

pair_style body/rounded/polygon ${c_n} ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 0.5 ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 0.5 0.5
pair_coeff * * ${k_n} ${k_na}
pair_coeff * * 100 ${k_na}
pair_coeff * * 100 2

comm_modify vel yes

neighbor     0.5 bin
neigh_modify every 1 delay 0 check yes

timestep     0.001

#fix         1 all nve/body
#fix         1 all nvt/body temp $T $T 1.0
fix          1 all npt/body temp $T $T 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 $T 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0 fixedpoint 0 0 0

fix          2 all enforce2d
fix          3 all wall/body/polygon 2000 50 50 yplane 0.0 48.0

#compute      1 all body/local id 1 2 3
#dump         1 all local 100000 dump.polygon.* index c_1[1] c_1[2] c_1[3] c_1[4]

thermo_style custom step ke pe etotal press
thermo       1000

#dump	     2 all image 10000 image.*.jpg type type zoom 2.0 #             adiam 1.5 body type 0 0
#dump_modify  2 pad 6

run          ${steps}
run          100000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.15685
  ghost atom cutoff = 6.15685
  binsize = 3.07843, bins = 16 16 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair body/rounded/polygon, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d/newton
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.773 | 4.773 | 4.773 Mbytes
Step KinEng PotEng TotEng Press 
       0     0.484375         0.25     0.734375 0.0067274306 
    1000   0.49241101 0.0031318767   0.49554289  0.017768281 
    2000   0.56118632 0.0026068888   0.56379321  0.003410416 
    3000   0.75565115  0.025578366   0.78122951 0.0071862988 
    4000   0.72298647  0.093150646   0.81613712  0.003190158 
    5000   0.51684166  0.049164868   0.56600653 0.0096960168 
    6000   0.56627905  0.048132853    0.6144119  0.020733586 
    7000   0.58122129  0.018223718   0.59944501 0.0038160759 
    8000   0.64297977  0.025934821   0.66891459 0.0041091784 
    9000   0.41748404 0.0077890042   0.42527305 0.0039270065 
   10000   0.35738377  0.078487805   0.43587158 3.9079865e-05 
   11000   0.41529307   0.13619284   0.55148591 -0.0067482285 
   12000   0.43274718  0.071315527   0.50406271  0.007006369 
   13000    0.4748324  0.069905666   0.54473807 0.0010385254 
   14000   0.62603727  0.098905625    0.7249429 0.0048876764 
   15000   0.44512086   0.10415235   0.54927321   0.01902062 
   16000   0.47460177   0.18053316   0.65513493  0.045013976 
   17000   0.52742676   0.10110706   0.62853382  0.013615471 
   18000   0.46111734  0.096118795   0.55723613 0.0073676834 
   19000   0.59668439   0.13652292   0.73320731  0.029403553 
   20000   0.46840192   0.11611719   0.58451911 -0.00034412499 
   21000   0.53550533  0.096457461    0.6319628 0.0019785732 
   22000   0.46599715   0.13206373   0.59806087  0.031970672 
   23000   0.49280776   0.20404726   0.69685501   0.03657433 
   24000   0.60901688   0.18255214   0.79156902  0.044955017 
   25000   0.47345185   0.13671357   0.61016542  0.020313539 
   26000   0.47653832   0.12448225   0.60102057   0.01878099 
   27000   0.50008212   0.24740634   0.74748845  0.021862639 
   28000   0.41627204    0.2519463   0.66821834  0.054683701 
   29000   0.55608273   0.23100212   0.78708485 -0.0043318497 
   30000   0.53884537    0.3001584   0.83900377 -0.012838186 
   31000   0.53036238    0.2300328   0.76039518 -0.0061688449 
   32000   0.42666792   0.20536256   0.63203048  0.045305282 
   33000   0.62908185    0.1652033   0.79428515 0.0072777588 
   34000   0.47028154     0.388736   0.85901754   0.04332288 
   35000   0.54602322    0.2775624   0.82358562   0.02898206 
   36000   0.59860544   0.21824655   0.81685199 0.0025936194 
   37000   0.62467827   0.11983499   0.74451326  0.050052743 
   38000   0.72594229   0.36584781    1.0917901   0.04280621 
   39000   0.51129656   0.23859043   0.74988699  0.050817447 
   40000   0.53263836   0.24212889   0.77476725  0.036245922 
   41000   0.50288088   0.36668283   0.86956371  0.018381415 
   42000   0.46653688   0.21974887   0.68628574  0.012661062 
   43000   0.61738785   0.32131037   0.93869821  0.012709433 
   44000   0.56603903   0.26515554   0.83119457   0.03315102 
   45000   0.56231638   0.32111693   0.88343331   0.06079756 
   46000    0.7096208    0.2570131   0.96663391  0.048770468 
   47000     0.588755    0.1880748    0.7768298  0.035962604 
   48000   0.56296339   0.25783519   0.82079858  0.053019928 
   49000     0.419885   0.42328618   0.84317118  0.038105269 
   50000   0.63073351   0.41426285    1.0449964 0.0015271048 
   51000   0.59357935     0.184222   0.77780136  0.015996218 
   52000   0.60608471   0.36247533   0.96856003   0.10984665 
   53000    0.5227842   0.27686739   0.79965159   0.02761699 
   54000   0.39435923   0.34197355   0.73633278  0.061183263 
   55000   0.46748455   0.34230903   0.80979358  0.077441382 
   56000   0.59819827   0.29212061   0.89031889  0.043772353 
   57000   0.61682559   0.32788566   0.94471124   0.03992069 
   58000   0.52702478   0.24891506   0.77593984  0.058480883 
   59000   0.66925719    0.4109031    1.0801603  0.072434423 
   60000   0.66807714   0.39233068    1.0604078  0.082370324 
   61000    0.5724275   0.43308567    1.0055132 0.0072945426 
   62000   0.49433556   0.38453743   0.87887299 0.0036097443 
   63000   0.57575143   0.54067119    1.1164226  0.073339638 
   64000   0.68045383   0.38246533    1.0629192  0.025314593 
   65000   0.59843527   0.42928622    1.0277215 -0.030096445 
   66000   0.60274797   0.50186417    1.1046121  0.069797184 
   67000   0.47450407   0.52689807    1.0014021  0.008758012 
   68000    0.5514135   0.64113187    1.1925454  0.093863314 
   69000   0.52008074   0.45749565   0.97757639 -0.066061381 
   70000   0.69042662   0.50416006    1.1945867  0.014128617 
   71000   0.63925854   0.35153425    0.9907928  -0.01134957 
   72000   0.52088835   0.47626986   0.99715821   0.10198133 
   73000   0.46333852    0.5515537    1.0148922 0.00060582772 
   74000   0.53481418   0.50409531    1.0389095   0.00919451 
   75000   0.67182749   0.50380162    1.1756291  0.043301985 
   76000   0.70492289    0.4112122    1.1161351   0.14880484 
   77000   0.59781817   0.50197661    1.0997948 -0.057111711 
   78000   0.51677429    0.4348232   0.95159749 -0.0074619446 
   79000   0.50663297   0.55000424    1.0566372 0.0052071216 
   80000   0.59392006   0.48394003    1.0778601 -0.018990234 
   81000   0.66323593   0.40358336    1.0668193  -0.02961345 
   82000   0.61596979   0.49177944    1.1077492    0.1314853 
   83000   0.63917554   0.61656584    1.2557414   0.11908351 
   84000   0.49305291   0.46161646   0.95466937  0.033558488 
   85000   0.52552044   0.54250555     1.068026   0.13015174 
   86000   0.55140914   0.38924725   0.94065638  0.047412499 
   87000   0.60952504   0.52603688    1.1355619  0.039230066 
   88000   0.50119735     0.547539    1.0487364  0.019659933 
   89000   0.40331401   0.50331134   0.90662535 -0.056906034 
   90000   0.47067839   0.51306911    0.9837475   0.11918166 
   91000   0.45564995   0.38693455    0.8425845   0.12040045 
   92000   0.64163032   0.34232532   0.98395564 0.0057051641 
   93000   0.70375593   0.53646186    1.2402178   0.16044241 
   94000   0.53378112   0.51971406    1.0534952   0.11389004 
   95000   0.47055342   0.50396004   0.97451346  0.079424215 
   96000   0.59543473   0.40204536   0.99748009  0.096813093 
   97000   0.64821917   0.50051728    1.1487365  0.054071312 
   98000   0.55723937    0.4945909    1.0518303  0.047316424 
   99000   0.56044424   0.50773312    1.0681774    0.0149959 
  100000   0.68254229   0.32704484    1.0095871 0.0069212661 
Loop time of 2.20043 on 4 procs for 100000 steps with 32 atoms

Performance: 3926501.701 tau/day, 45445.622 timesteps/s
100.0% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.41008    | 0.41366    | 0.41719    |   0.4 | 18.80
Neigh   | 0.0027823  | 0.0030481  | 0.0034747  |   0.5 |  0.14
Comm    | 0.74581    | 0.7675     | 0.78684    |   2.0 | 34.88
Output  | 0.00082111 | 0.0010884  | 0.0016899  |   1.1 |  0.05
Modify  | 0.83828    | 0.85329    | 0.86656    |   1.4 | 38.78
Other   |            | 0.1618     |            |       |  7.36

Nlocal:    8 ave 9 max 7 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Nghost:    12.75 ave 14 max 12 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:    11 ave 19 max 5 min
Histogram: 1 0 0 2 0 0 0 0 0 1

Total # of neighbors = 44
Ave neighs/atom = 1.375
Neighbor list builds = 2663
Dangerous builds = 0
Total wall time: 0:00:02
