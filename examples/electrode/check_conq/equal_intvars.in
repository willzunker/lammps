variable tag string equal_intvars
log log.lammps_${tag}
atom_style full
units real
bond_style harmonic
angle_style harmonic

include "p3m3dc.settings"
boundary p p f
pair_style 	lj/cut/coul/long 16 16
processors * * 2

read_data "cap.data"
include "cgil.settings"

#dump alldump all custom 1000 all_${tag}.lammpstrj id mol type x y z q
fix            fxnvt electrolyte nvt temp 500.0 500.0 100.
variable       qtop equal 1.0
variable       qbot equal -v_qtop

variable       qsb_bot internal 0.0
variable       me00 internal 0.0
variable       vbot equal v_me00*(v_qbot-v_qsb_bot)
variable       vtop equal -v_vbot

fix            fxupdate bot electrode/conp v_vbot 1.979 couple top v_vtop symm on
fix_modify     fxupdate set qsb bot qsb_bot
fix_modify     fxupdate set me bot bot me00
variable       q atom q
compute        qtop top reduce sum v_q
compute        qbot bot reduce sum v_q
compute        qall ele reduce sum v_q
compute        ctemp electrolyte temp

fix print all print 10 "$(step:%8.3g) $(c_qtop:%20.15e) $(c_qbot:%20.15e) $(v_vtop:%20.15e) $(v_vbot:%20.15e)" file ${tag}.csv screen no title "#Fix electrode conq test  setting = equal, emulated with conp"

thermo 10
thermo_style custom step c_ctemp epair etotal c_qtop c_qbot c_qall v_vbot v_vtop
run 50
