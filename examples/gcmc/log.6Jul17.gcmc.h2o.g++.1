LAMMPS (22 Sep 2017)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (../comm.cpp:90)
  using 1 OpenMP thread(s) per MPI task
# fix gcmc example with fix shake

# variables available on command line

variable        mu index -8.1
variable	disp index 0.5
variable        temp index 338.0
variable        lbox index 10.0
variable        spacing index 5.0

# global model settings

units           real
atom_style      full
boundary        p p p
pair_style      lj/cut/coul/long  14
pair_modify     mix arithmetic tail yes
kspace_style    ewald 0.0001
bond_style      harmonic
angle_style     harmonic

# box, start molecules on simple cubic lattice

lattice 	sc ${spacing}
lattice 	sc 5.0
Lattice spacing in x,y,z = 5 5 5
region          box block 0 ${lbox} 0 ${lbox} 0 ${lbox} units box
region          box block 0 10.0 0 ${lbox} 0 ${lbox} units box
region          box block 0 10.0 0 10.0 0 ${lbox} units box
region          box block 0 10.0 0 10.0 0 10.0 units box
create_box      2 box                                       bond/types 1                                angle/types 1                               extra/bond/per/atom 2                       extra/angle/per/atom 1                      extra/special/per/atom 2
Created orthogonal box = (0 0 0) to (10 10 10)
  1 by 1 by 1 MPI processor grid

# we can load multiple molecule templates, but don't have to use them all
molecule        co2mol CO2.txt
Read molecule co2mol:
  3 atoms with 2 types
  2 bonds with 1 types
  1 angles with 1 types
  0 dihedrals with 0 types
  0 impropers with 0 types
molecule        h2omol H2O.txt
Read molecule h2omol:
  3 atoms with 2 types
  2 bonds with 1 types
  1 angles with 1 types
  0 dihedrals with 0 types
  0 impropers with 0 types
create_atoms   	0 box mol h2omol 464563 units box
Created 24 atoms
  Time spent = 0.00136209 secs

# rigid SPC/E water model

pair_coeff      1 1 0.15535 3.166
pair_coeff      * 2 0.0000 0.0000

bond_coeff      1     1000       1.0
angle_coeff     1      100       109.47

# masses

mass 1 15.9994
mass 2 1.0

# MD settings

group           h2o type 1 2
24 atoms in group h2o
neighbor        2.0 bin
neigh_modify    every 1 delay 1 check yes
velocity       	all create ${temp} 54654
velocity       	all create 338.0 54654
timestep        1.0

minimize 0.0 0.0 100 1000
WARNING: Using 'neigh_modify every 1 delay 0 check yes' setting during minimization (../min.cpp:168)
Ewald initialization ...
WARNING: Using 12-bit tables for long-range coulomb (../kspace.cpp:321)
  G vector (1/distance) = 0.170448
  estimated absolute RMS force accuracy = 0.0332064
  estimated relative force accuracy = 0.0001
  KSpace vectors: actual max1d max3d = 16 2 62
                  kxmax kymax kzmax  = 2 2 2
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 16
  ghost atom cutoff = 16
  binsize = 8, bins = 2 2 2
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d/newton
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 11.88 | 11.88 | 11.88 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0          338   -4.1890564 9.2628112e-06     18.98377    739.06991 
     100          338   -27.771871   0.61137788   -3.9876753   -2259.9107 
Loop time of 0.0333829 on 1 procs for 100 steps with 24 atoms

99.8% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = max iterations
  Energy initial, next-to-last, final = 
        -4.18904713252     -26.8589493819     -27.1604926722
  Force two-norm initial, final = 18.0027 28.6823
  Force max component initial, final = 5.8993 11.77
  Final line search alpha, max atom move = 0.00301381 0.0354725
  Iterations, force evaluations = 100 239

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.028252   | 0.028252   | 0.028252   |   0.0 | 84.63
Bond    | 0.00025415 | 0.00025415 | 0.00025415 |   0.0 |  0.76
Kspace  | 0.0017328  | 0.0017328  | 0.0017328  |   0.0 |  5.19
Neigh   | 0.00038004 | 0.00038004 | 0.00038004 |   0.0 |  1.14
Comm    | 0.0022359  | 0.0022359  | 0.0022359  |   0.0 |  6.70
Output  | 2.1935e-05 | 2.1935e-05 | 2.1935e-05 |   0.0 |  0.07
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0005062  |            |       |  1.52

Nlocal:    24 ave 24 max 24 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    2047 ave 2047 max 2047 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    4939 ave 4939 max 4939 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 4939
Ave neighs/atom = 205.792
Ave special neighs/atom = 2
Neighbor list builds = 2
Dangerous builds = 0
reset_timestep 0
# rigid constraints with thermostat

fix             mynvt all nvt temp ${temp} ${temp} 100
fix             mynvt all nvt temp 338.0 ${temp} 100
fix             mynvt all nvt temp 338.0 338.0 100
fix             wshake  all shake 0.0001 50 0 b 1 a 1 mol h2omol
  0 = # of size 2 clusters
  0 = # of size 3 clusters
  0 = # of size 4 clusters
  8 = # of frozen angles
# gcmc



run 1000
Ewald initialization ...
WARNING: Using 12-bit tables for long-range coulomb (../kspace.cpp:321)
  G vector (1/distance) = 0.170448
  estimated absolute RMS force accuracy = 0.0332064
  estimated relative force accuracy = 0.0001
  KSpace vectors: actual max1d max3d = 16 2 62
                  kxmax kymax kzmax  = 2 2 2
Per MPI rank memory allocation (min/avg/max) = 11.63 | 11.63 | 11.63 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0    518.26667   -27.771871            0   -4.5990532    3.1322213 
    1000     277.5448   -45.272615            0    -32.86299   -1575.2641 
Loop time of 0.101694 on 1 procs for 1000 steps with 24 atoms

Performance: 849.609 ns/day, 0.028 hours/ns, 9833.435 timesteps/s
99.2% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.078345   | 0.078345   | 0.078345   |   0.0 | 77.04
Bond    | 0.00010109 | 0.00010109 | 0.00010109 |   0.0 |  0.10
Kspace  | 0.0079424  | 0.0079424  | 0.0079424  |   0.0 |  7.81
Neigh   | 0.003454   | 0.003454   | 0.003454   |   0.0 |  3.40
Comm    | 0.0080469  | 0.0080469  | 0.0080469  |   0.0 |  7.91
Output  | 1.9073e-05 | 1.9073e-05 | 1.9073e-05 |   0.0 |  0.02
Modify  | 0.0026064  | 0.0026064  | 0.0026064  |   0.0 |  2.56
Other   |            | 0.001179   |            |       |  1.16

Nlocal:    24 ave 24 max 24 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1688 ave 1688 max 1688 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    4952 ave 4952 max 4952 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 4952
Ave neighs/atom = 206.333
Ave special neighs/atom = 2
Neighbor list builds = 26
Dangerous builds = 0

variable        tfac equal 5.0/3.0 # (3 trans + 2 rot)/(3 trans)
fix             mygcmc all gcmc 100 100 0 0 54341 ${temp} ${mu} ${disp} mol                 h2omol tfac_insert ${tfac} group h2o shake wshake
fix             mygcmc all gcmc 100 100 0 0 54341 338.0 ${mu} ${disp} mol                 h2omol tfac_insert ${tfac} group h2o shake wshake
fix             mygcmc all gcmc 100 100 0 0 54341 338.0 -8.1 ${disp} mol                 h2omol tfac_insert ${tfac} group h2o shake wshake
fix             mygcmc all gcmc 100 100 0 0 54341 338.0 -8.1 0.5 mol                 h2omol tfac_insert ${tfac} group h2o shake wshake
fix             mygcmc all gcmc 100 100 0 0 54341 338.0 -8.1 0.5 mol                 h2omol tfac_insert 1.66666666666667 group h2o shake wshake

# atom counts

variable 	oxygen atom "type==1"
variable 	hydrogen atom "type==2"
group 	        oxygen dynamic all var oxygen
dynamic group oxygen defined
group 		hydrogen dynamic all var hydrogen
dynamic group hydrogen defined
variable        nO equal count(oxygen)
variable        nH equal count(hydrogen)

# output

variable	tacc equal f_mygcmc[2]/(f_mygcmc[1]+0.1)
variable	iacc equal f_mygcmc[4]/(f_mygcmc[3]+0.1)
variable	dacc equal f_mygcmc[6]/(f_mygcmc[5]+0.1)
variable	racc equal f_mygcmc[8]/(f_mygcmc[7]+0.1)
compute_modify  thermo_temp dynamic/dof yes
thermo_style    custom step temp press pe ke density atoms v_iacc v_dacc v_tacc v_racc v_nO v_nH
thermo          1000

# run

run             20000
Ewald initialization ...
WARNING: Using 12-bit tables for long-range coulomb (../kspace.cpp:321)
  G vector (1/distance) = 0.170448
  estimated absolute RMS force accuracy = 0.0332064
  estimated relative force accuracy = 0.0001
  KSpace vectors: actual max1d max3d = 16 2 62
                  kxmax kymax kzmax  = 2 2 2
WARNING: Fix gcmc using full_energy option (../fix_gcmc.cpp:445)
0 atoms in group FixGCMC:gcmc_exclusion_group:mygcmc
0 atoms in group FixGCMC:rotation_gas_atoms:mygcmc
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (../neighbor.cpp:476)
Per MPI rank memory allocation (min/avg/max) = 11.63 | 11.63 | 11.63 Mbytes
Step Temp Press PotEng KinEng Density Atoms v_iacc v_dacc v_tacc v_racc v_nO v_nH 
    1000     277.5448   -1575.1516   -45.272615    12.409625   0.23910963       24            0            0            0            0            8           16 
    2000     84.31104   -7419.6538   -330.36966    13.319705   0.80699501       81  0.048183096 0.0099581757            0            0           27           54 
    3000    79.654082   -7034.6542   -345.84563    13.058853   0.83688372       84  0.027492109 0.0068755525            0            0           28           56 
    4000    73.831702   -3905.1456   -380.27757    12.984619   0.89666113       90  0.020637774 0.0060076096            0            0           30           60 
    5000    95.397292   -3523.6886    -414.9618    18.483479   0.98632724       99  0.016897769 0.0045269353            0            0           33           66 
    6000     74.46018   -4913.3009   -425.33102    14.426857   0.98632724       99  0.013390571 0.0036569014            0            0           33           66 
    7000    59.601812   -3108.7781   -425.91441    11.548009   0.98632724       99   0.01160439 0.0033510941            0            0           33           66 
    8000    74.104787   -1710.7687   -444.03326    14.799784    1.0162159      102  0.010174953 0.0028884203            0            0           34           68 
    9000    92.497957   -1255.2193   -435.57266    18.473162    1.0162159      102 0.0089594585 0.0025112378            0            0           34           68 
   10000    71.075249   -3191.4633   -454.19438    14.618465    1.0461046      105 0.0081585853 0.0022395915            0            0           35           70 
   11000    60.402203   -2011.6602   -461.68383    12.423277    1.0461046      105 0.0073396679 0.0020164949            0            0           35           70 
   12000    92.903919   -3023.4452   -462.20701    19.108096    1.0461046      105 0.0066641451 0.0018355023            0            0           35           70 
   13000    51.285407   -1016.3672   -466.29402    10.548172    1.0461046      105 0.0061145907 0.0016809265            0            0           35           70 
   14000    72.733554   -3284.3632   -463.38578    14.959539    1.0461046      105 0.0056427384 0.0015520479            0            0           35           70 
   15000    76.324778   -1795.0839   -477.59722    16.153186    1.0759934      108  0.005391524 0.0014384143            0            0           36           72 
   16000    78.185379    345.92387    -481.1903    16.546959    1.0759934      108 0.0050257238 0.0013442486            0            0           36           72 
   17000    79.868226    -3095.839   -478.59141    16.903113    1.0759934      108 0.0047204383 0.0012578458            0            0           36           72 
   18000    69.578814   -1884.4164   -482.28013    14.725487    1.0759934      108 0.0044407568 0.0011843991            0            0           36           72 
   19000    73.973471   -1943.8906   -480.82986    15.655561    1.0759934      108 0.0042016342 0.0011165574            0            0           36           72 
   20000    59.614528   -2439.1076   -485.78451    12.616671    1.0759934      108 0.0040927265 0.0011614279            0            0           36           72 
   21000    89.393596   -728.94872   -484.62787    18.919038    1.0759934      108 0.0038871336 0.0011036309            0            0           36           72 
Loop time of 148.361 on 1 procs for 20000 steps with 108 atoms

Performance: 11.647 ns/day, 2.061 hours/ns, 134.806 timesteps/s
99.9% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 26.404     | 26.404     | 26.404     |   0.0 | 17.80
Bond    | 0.058909   | 0.058909   | 0.058909   |   0.0 |  0.04
Kspace  | 0.58222    | 0.58222    | 0.58222    |   0.0 |  0.39
Neigh   | 0.81976    | 0.81976    | 0.81976    |   0.0 |  0.55
Comm    | 0.60514    | 0.60514    | 0.60514    |   0.0 |  0.41
Output  | 0.00070596 | 0.00070596 | 0.00070596 |   0.0 |  0.00
Modify  | 119.77     | 119.77     | 119.77     |   0.0 | 80.73
Other   |            | 0.1157     |            |       |  0.08

Nlocal:    108 ave 108 max 108 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    7908 ave 7908 max 7908 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    99854 ave 99854 max 99854 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 99854
Ave neighs/atom = 924.574
Ave special neighs/atom = 2
Neighbor list builds = 20442
Dangerous builds = 0

Total wall time: 0:02:28
