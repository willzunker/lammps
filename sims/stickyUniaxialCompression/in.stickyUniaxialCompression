############################### SIMULATION SETTINGS ###################################################

atom_style sphere 
atom_modify map array 
comm_modify vel yes
units si
newton off
neighbor      6 bin
neigh_modify  delay 0
timestep 0.001

######################### SIMULATION BOUNDING BOX, INTEGRATION, AND, GRAVITY ###########################

boundary f f f
region simBox block -100 100 -100 100 -100 100
create_box 2 simBox

########################### PARTICLE MATERIAL PROPERTIES AND FORCE MODEL ###############################

pair_style granular
# E, nu, Y, gamma, psi_b, CoR
pair_coeff * * mdr 1e6 0.3 8e4 50 0.08 1.0 tangential linear_nohistory 0.0 0.0

##################################### INSERT PARTICLES ####################################################

create_atoms 1 single 0 0 0 units box
group centerAtom id 1
variable d equal 2
variable den equal 1000
set atom 1 diameter ${d} density ${den} 

######################################## SCREEN OUTPUT  ####################################################

compute       1 all erotate/sphere
thermo_style  custom dt step atoms ke c_1 vol 
thermo        1000
thermo_modify lost ignore norm no

##################################### DEFINE RUN CONTROL VARIBLES  #############################################

variable mydt equal dt
variable mystep equal step
variable mytime equal ${mydt}*v_mystep
variable freq equal 1.0/(20.0*${mydt})
variable dispMax equal 0.01 #${d}/4
variable disp equal ${dispMax}*sin(${freq}*v_mytime)
variable disp_neg equal v_disp
variable vel equal ${dispMax}*${freq}*cos(${freq}*v_mytime)
variable vel_neg equal -v_vel
variable zeroDisp equal 0.0
variable disp_neg equal -v_disp

fix cAtom centerAtom move variable v_zeroDisp NULL NULL NULL NULL NULL units box 

######################################### ADD IN PLANES ################################################

region plane_yz_pos plane 1 0 0 -1 0 0 side in move v_disp_neg NULL NULL units box
region plane_yz_neg plane -1 0 0 1 0 0 side in move v_disp NULL NULL units box

variable wall_contact_string string "granular mdr 1e6 0.3 8e4 50 0.08 1.0 tangential linear_nohistory 0.0 0.0"

fix plane_yz_pos all wall/gran/region ${wall_contact_string} region plane_yz_pos contacts
fix plane_yz_neg all wall/gran/region ${wall_contact_string} region plane_yz_neg contacts

##################################### SET UP DUMP OUTPUTS  ####################################################

dump dumpParticles all vtk 1 post/particles_*.vtk x y z fx fy fz 
dumpÂ 1 all custom 1 stickyUniaxialCompression id type f_plane_yz_neg[*]

######################################### BEGIN RUN  ##########################################################

run 100 upto